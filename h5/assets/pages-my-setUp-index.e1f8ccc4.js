import{e,r as l,t,a,o as s,W as o,ag as i,E as n,f as c,g as r,w as u,i as d,p as f,q as m,u as p,F as y,j as v,l as h,b6 as x,$ as g,aw as k,x as _,aq as C,v as b,k as w,m as N,n as E,ar as B,V as I,h as L,b7 as F,y as S,C as T,b0 as $,b8 as M}from"./index.1a866322.js";import{_ as j}from"./u-icon.1541541b.js";import{o as D,r as O}from"./uni-app.es.5638d019.js";import"./index.0e6263ad.js";import{u as P}from"./useState.33e874ff.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";var V=z({__name:"index",setup(z){const V=P(["MerchantId","islogin","userinfo"]),{MerchantId:H,islogin:U,userinfo:q}=V,A=e((()=>K("start"))),R=e((()=>K("end"))),J=l({infoList:[{title:"头像",type:"HeadPicture",value:""},{title:"昵称",type:"NickName",value:""},{title:"姓名",type:"Name",value:"",maxLength:10,realName:!1,showValue:"独一无二",placeholder:"姓名",noBottom:!0},{title:"生日",type:"Birthday",value:"",showValue:"收获生日惊喜",placeholder:"请选择生日",lineTop:!0},{title:"性别",type:"Sex",value:0,showsexList:[{type:"iconnan",name:"男",color:"#3977FE",Code:1},{type:"iconnv",name:"女",color:"#E8393E",Code:2}]},{title:"邮箱",type:"Email",value:"",maxLength:30,showValue:"接收通知",placeholder:"请输入邮箱",noBottom:!0},{title:"我的地址",type:"Address",url:"address"},{title:"修改密码",type:"Password",url:"forget",lineTop:!0}],wxdata:{}}),{infoList:W,wxdata:Y}=t(J);a("");const G=a(!1);function K(e){const l=new Date;let t=l.getFullYear(),a=l.getMonth()+1,s=l.getDate();return"start"===e&&(t-=20),a=a>9?a:"0"+a,s=s>9?s:"0"+s,`${t}-${a}-${s}`}function Q(){if(U.value){let e={permission:"Member-UserInformation",queryField:"UserId,HeadPicture,Name,Address,Birthday,NickName,Email,Sex,Mobile",entityName:"CirclesFinancial.Modals.User,CirclesFinancial.Modals",whereField:JSON.stringify({})};i(e).then((e=>{const l=e.Result;if(l&&"object"==typeof l&&l.length>0){const e=l[0];for(let l in e){const t=J.infoList.findIndex((e=>e.type==l)),a="Mobile"==l?e[l].replace(reg,"$1****$3"):e[l];t>-1&&(J.infoList[t].value=a,J.infoList[t].initValue=a)}}})).catch((e=>{}))}else n({animationType:"slide-in-bottom",url:"../../login/index"})}function X(e,l){let t=e,a=L(q.value);console.log("vuex==>",L(q.value)),F(t).then((t=>{if(t.Result&&"success"==t.Result){switch(uni.$u.toast("保存成功"),l){case"Name":g.commit("userinfo",{...a,userName:e.Name});break;case"Email":g.commit("userinfo",{...a,Email:e.Email});break;case"Sex":g.commit("userinfo",{...a,Sex:e.Sex})}Q()}})).catch((e=>{}))}function Z(e){const l=J.infoList.findIndex((e=>"Birthday"==e.type));let t={};t.Birthday=J.infoList[l].value=e.detail.value,console.log("更新信息"),X(t)}function ee(){x(),g.state.islogin=!1,k({delta:1})}return s((()=>{location.href.indexOf("3000")>0&&(G.value=!0),console.log("路由参数=onMounted==>")})),D((e=>{console.log("路由参数=onLoad==>"),J.wxdata=o("wxdata"),Q()})),(e,l)=>{const t=S,a=T,s=d,o=$,i=M,x=O(_("u-icon"),j),g=C;return c(),r(s,{class:"page"},{default:u((()=>[(c(!0),f(y,null,m(p(W),((l,d)=>(c(),r(s,{onClick:e=>function(e){switch(console.log("修改信息==>",e),e.type){case"Name":case"Email":I({title:`${e.title}修改`,content:"",placeholderText:`请输入你的新${e.title}`,editable:!0,success:function(l){if(l.confirm)if(console.log("用户点击确定",l.content),l.content.length<=0)uni.$u.toast("请输入正确信息");else{const t={};t[e.type]=l.content,X(t,e.type)}else l.cancel&&console.log("用户点击取消")}});break;case"Password":n({url:"../forget/index?setUpBoole=true"});break;case"Address":n({url:"../../address/index"});break;case"Sex":console.log("修改性别==>",e),I({title:"提示",content:"你确定要修改性别吗？",success:l=>{if(l.confirm){const l=J.infoList.findIndex((e=>"Sex"==e.type));let t={};t.Sex=J.infoList[l].value=1==e.value?"2":"1",console.log("更新信息"),X(t,e.type)}}})}}(l),class:b(["page","cellDiv","clickBefore",l.lineTop?"lineTop":""]),key:d},{default:u((()=>["HeadPicture"==l.type?(c(),r(s,{key:0,class:b(["cellItem",l.noBottom?"":"lineClass"])},{default:u((()=>[w(t,{class:"cellTitle"},{default:u((()=>[h(N(l.title),1)])),_:2},1024),w(a,{src:p(Y).headimgurl||p(q).headPicture||"../../../static/head.png",mode:"aspectFill",class:"imgClass"},null,8,["src"])])),_:2},1032,["class"])):v("v-if",!0),"NickName"==l.type?(c(),r(s,{key:1,class:b(["cellItem",l.noBottom?"":"lineClass"])},{default:u((()=>[w(t,{class:"cellTitle"},{default:u((()=>[h(N(l.title),1)])),_:2},1024),w(t,{class:"cellName textOverflowClass",style:E({color:l.value?"#999":"#cacaca"})},{default:u((()=>[h(N(p(Y).nickname||p(q).nickName),1)])),_:2},1032,["style"])])),_:2},1032,["class"])):v("v-if",!0),"Birthday"==l.type?(c(),r(s,{key:2,class:b(["cellItem",l.noBottom?"":"lineClass"])},{default:u((()=>[w(t,{class:"cellTitle"},{default:u((()=>[h(N(l.title),1)])),_:2},1024),w(o,{mode:"date",start:p(A),end:p(R),onChange:Z},{default:u((()=>[w(s,{class:"uni-input"},{default:u((()=>[h(N(l.value||"请选择生日"),1)])),_:2},1024)])),_:2},1032,["start","end"])])),_:2},1032,["class"])):v("v-if",!0),"switch"==l.type?(c(),r(s,{key:3,onClick:B((e=>null),["stop"]),class:b(["cellItem","lineClass"]),style:{"padding-right":"0px"}},{default:u((()=>[w(t,{class:"cellTitle"},{default:u((()=>[h(N(l.title),1)])),_:2},1024),w(i,{color:"#F68316",value:e.hadOpen.checked,checked:e.hadOpen.checked,onChange:e.bindSwitch},null,8,["value","checked","onChange"])])),_:2},1032,["onClick"])):v("v-if",!0),"outLogin"==l.type?(c(),r(t,{key:4,class:"outDiv"},{default:u((()=>[h("退出登录")])),_:1})):v("v-if",!0),"Sex"==l.type?(c(),r(s,{key:5,class:b(["cellItem",l.noBottom?"":"lineClass"]),style:{"padding-right":"0px"}},{default:u((()=>[w(t,{class:"cellTitle"},{default:u((()=>[h(N(l.title),1)])),_:2},1024),w(s,{class:"sexDiv"},{default:u((()=>[1*l.value>=0?(c(),r(s,{key:0,class:"sexCell sexDiv",style:E({borderColor:1==l.value?"#3977FE":"#E8393E",backgroundColor:1==l.value==1?"#3977FE":"#E8393E"})},{default:u((()=>[w(x,{name:1==l.value?"man":"woman",color:"#fff",size:"40"},null,8,["name"]),w(t,{style:{"padding-left":"10rpx","font-size":"28rpx",color:"#fff"}},{default:u((()=>[h(N(1==l.value?"男":"女"),1)])),_:2},1024)])),_:2},1032,["style"])):(c(),r(s,{key:1,class:"sexCell sexDiv",style:E({borderColor:1==p(Y).sex?"#3977FE":"#E8393E",backgroundColor:1==p(Y).sex?"#3977FE":"#E8393E"})},{default:u((()=>[w(x,{name:1==p(Y).sex?"man":"woman",color:"#fff",size:"40"},null,8,["name"]),w(t,{style:{"padding-left":"10rpx","font-size":"28rpx",color:"#fff"}},{default:u((()=>[h(N(1==p(Y).sex?"男":"女"),1)])),_:1})])),_:1},8,["style"]))])),_:2},1024)])),_:2},1032,["class"])):v("v-if",!0),"HeadPicture"!=l.type&&"outLogin"!=l.type&&"Sex"!=l.type&&"NickName"!=l.type&&"NickName"!=l.type&&"switch"!=l.type&&"Birthday"!=l.type?(c(),r(s,{key:6,class:b(["cellItem",l.noBottom?"":"lineClass"])},{default:u((()=>[w(t,{class:"cellTitle"},{default:u((()=>[h(N(l.title),1)])),_:2},1024),l.value?(c(),r(t,{key:0,class:"cellName textOverflowClass",style:E({color:l.value?"#999":"#cacaca"})},{default:u((()=>[h(N(l.value),1)])),_:2},1032,["style"])):(c(),r(t,{key:1,class:"cellName textOverflowClass",style:E({color:l.value?"#999":"#cacaca"})},{default:u((()=>[w(x,{name:"arrow-right",color:"#999",size:"28"})])),_:2},1032,["style"])),v(' <view v-if="item.newBool" class="unread"></view> '),v(' <shm-icons @click="cellClick(item)" class="rightIcon" color="#cacaca" size="35" type="iconnext-copy">\n            </shm-icons> ')])),_:2},1032,["class"])):v("v-if",!0)])),_:2},1032,["onClick","class"])))),128)),v(" 仅开发模式显示 "),v(' <button v-if="dev" @click="clean">清除缓存</button> '),"15701259892"==p(q).mobile||"13233440273"==p(q).mobile||"13520645281"==p(q).mobile||"15501181177"==p(q).mobile||"18522619737"==p(q).mobile||"17603592124"==p(q).mobile?(c(),r(g,{key:0,onClick:ee},{default:u((()=>[h("清除缓存(仅开发人员显示)V1")])),_:1})):v("v-if",!0)])),_:1})}}},[["__scopeId","data-v-35197520"]]);export{V as default};
