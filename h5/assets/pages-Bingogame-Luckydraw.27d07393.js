import{Y as t,aD as e,B as i,f as n,g as a,w as r,k as o,n as s,j as l,aE as c,C as h,aF as u,i as d,a as f,r as p,t as g,aG as m,o as y,aH as v,s as w,aI as b,aJ as k,h as x,an as C,u as A,z,l as S,m as I,aK as L,V as D,aL as _,aM as T,aN as R,aq as F,x as E,ay as W,y as O}from"./index.1a866322.js";import{_ as M,a as B,b as P}from"./uni-forms.90eb198d.js";import{o as j,a as H,c as $,r as U}from"./uni-app.es.5638d019.js";import{_ as V,a as G}from"./u-radio-group.12866b1c.js";import{_ as N}from"./u-parse.58a54c5b.js";import{_ as X}from"./u-modal.f80ad17e.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";import{n as q,o as Y}from"./methods.10d71805.js";import{w as Z}from"./wechatSdk.8caabd54.js";import{u as Q}from"./useState.33e874ff.js";/* empty css                                                          */import"./u-icon.1541541b.js";import"./emitter.5b880544.js";import"./u-popup.ac74065a.js";import"./index.0e6263ad.js";let J=t().windowWidth;J>960&&(J=375);const tt=t=>Number(t.replace(/^(\-*[0-9.]*)([a-z%]*)$/,((t,e,i)=>{switch(i){case"px":default:e*=1;break;case"rpx":e=(t=>("string"==typeof t&&(t=Number(t.replace(/[a-z]*/g,""))),J/750*t))(e)}return e})));function et(t,i){return new Promise(((n,a)=>{e({canvas:i,canvasId:t,success:t=>n(t),fail:t=>a(t)},this)}))}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var it=function(t,e){return(it=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function nt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}it(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var at=function(){return at=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var a in e=arguments[i])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},at.apply(this,arguments)};function rt(t,e,i,n){return new(i||(i=Promise))((function(a,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function s(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))}function ot(t,e){var i,n,a,r,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&r[0]?n.return:r[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){o.label=r[1];break}if(6===r[0]&&o.label<a[1]){o.label=a[1],a=r;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(r);break}a[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(s){r=[6,s],n=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function st(t,e){for(var i=0,n=e.length,a=t.length;i<n;i++,a++)t[a]=e[i];return t}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;for(var a,r,o=0|e,s=Math.max(o>=0?o:n-Math.abs(o),0);s<n;){if((a=i[s])===(r=t)||"number"==typeof a&&"number"==typeof r&&isNaN(a)&&isNaN(r))return!0;s++}return!1}}),String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],a=0;a<i;){var r=e[a];if(t.call(n,r,a,e))return r;a++}}});var lt=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.some((function(e){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===e}))},ct=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},ht=function(t){return[].filter.call(t,(function(t){return"\n"!==t})).join("")},ut=function(t){if("string"!=typeof t)return!1;if("transparent"===(t=t.toLocaleLowerCase().trim()))return!1;var e;if(/^rgba/.test(t)&&0===(null===(e=/([^\s,]+)\)$/.exec(t))?0:"object"==typeof e?NaN:"number"==typeof e?e:"string"==typeof e?"%"===e[e.length-1]?Number(e.slice(0,-1))/100:Number(e):NaN))return!1;return!0},dt=function(t,e){var i,n=(null===(i=t.padding)||void 0===i?void 0:i.split(" ").map((function(t){return e(t)})))||[0],a=0,r=0,o=0,s=0;switch(n.length){case 1:a=r=o=s=n[0];break;case 2:a=r=n[0],o=s=n[1];break;case 3:a=n[0],o=s=n[1],r=n[2];break;default:a=n[0],r=n[1],o=n[2],s=n[3]}var l={paddingTop:a,paddingBottom:r,paddingLeft:o,paddingRight:s};for(var c in l)l[c]=ct(t,c)&&lt(t[c],"string","number")?e(t[c]):l[c];return[a,r,o,s]},ft=function(t){var e=[],i=t.map((function(t){return Number(t)})).reduce((function(t,i){if(i>0){var n=t+i;return e.push(n),n}return e.push(NaN),t}),0),n=Math.random()*i;return e.findIndex((function(t){return n<=t}))},pt=function(t,e,i,n){void 0===n&&(n=1/0),n<=0&&(n=1/0);for(var a="",r=[],o=t.measureText("...").width,s=0;s<e.length;s++){a+=e[s];var l=t.measureText(a).width,c=i(r);if(n===r.length+1&&(l+=o),c<0)return r;if(l>c&&(r.push(a.slice(0,-1)),a=e[s]),n===r.length)return r[r.length-1]+="...",r}return a&&r.push(a),r.length||r.push(e),r},gt=function(){function t(){this.subs=[]}return t.prototype.addSub=function(t){this.subs.includes(t)||this.subs.push(t)},t.prototype.notify=function(){this.subs.forEach((function(t){t.update()}))},t}(),mt="__proto__"in{};function yt(t,e,i,n){Object.defineProperty(t,e,{value:i,enumerable:!!n,writable:!0,configurable:!0})}var vt=Array.prototype,wt=Object.create(vt);["push","pop","shift","unshift","sort","splice","reverse"].forEach((function(t){wt[t]=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=vt[t].apply(this,e),a=this.__luckyOb__;return["push","unshift","splice"].includes(t)&&a.walk(this),a.dep.notify(),n}}));var bt=function(){function t(t){this.dep=new gt,yt(t,"__luckyOb__",this),Array.isArray(t)&&(mt?t.__proto__=wt:Object.getOwnPropertyNames(wt).forEach((function(e){yt(t,e,wt[e])}))),this.walk(t)}return t.prototype.walk=function(t){Object.keys(t).forEach((function(e){xt(t,e,t[e])}))},t}();function kt(t){if(t&&"object"==typeof t)return"__luckyOb__"in t?t.__luckyOb__:new bt(t)}function xt(t,e,i){var n=new gt,a=Object.getOwnPropertyDescriptor(t,e);if(!a||!1!==a.configurable){var r=a&&a.get,o=a&&a.set;r&&!o||2!==arguments.length||(i=t[e]);var s=kt(i);Object.defineProperty(t,e,{get:function(){var e=r?r.call(t):i;return gt.target&&(n.addSub(gt.target),s&&s.dep.addSub(gt.target)),e},set:function(e){e!==i&&(i=e,r&&!o||(o?o.call(t,e):i=e,s=kt(e),n.notify()))}})}}var Ct=0,At=function(){function t(t,e,i,n){void 0===n&&(n={}),this.id=Ct++,this.$lucky=t,this.expr=e,this.deep=!!n.deep,this.getter="function"==typeof e?e:function(t){t+=".";for(var e=[],i="",n=0;n<t.length;n++){var a=t[n];if(/\[|\./.test(a))e.push(i),i="";else{if(/\W/.test(a))continue;i+=a}}return function(t){return e.reduce((function(t,e){return t[e]}),t)}}(e),this.cb=i,this.value=this.get()}return t.prototype.get=function(){gt.target=this;var t,e=this.getter.call(this.$lucky,this.$lucky);return this.deep&&(t=function(e){lt(e,"array","object")&&Object.keys(e).forEach((function(i){var n=e[i];t(n)}))})(e),gt.target=null,e},t.prototype.update=function(){var t=this.get(),e=this.value;this.value=t,this.cb.call(this.$lucky,t,e)},t}(),zt=function(){function t(t,e){var i=this;this.version="1.7.26",this.htmlFontSize=16,this.rAF=function(){},this.boxWidth=0,this.boxHeight=0,"string"==typeof t?t={el:t}:1===t.nodeType&&(t={el:"",divElement:t}),this.config=t,this.data=e,t.flag||(t.flag="WEB"),t.el&&(t.divElement=document.querySelector(t.el)),t.divElement&&(t.canvasElement=document.createElement("canvas"),t.divElement.appendChild(t.canvasElement)),t.canvasElement&&(t.ctx=t.canvasElement.getContext("2d"),t.canvasElement.setAttribute("package","lucky-canvas@1.7.26"),t.canvasElement.addEventListener("click",(function(t){return i.handleClick(t)}))),this.ctx=t.ctx,this.initWindowFunction(),this.config.ctx||console.error("无法获取到 CanvasContext2D"),window&&"function"==typeof window.addEventListener&&window.addEventListener("resize",function(t,e){void 0===e&&(e=300);var i=null;return function(){for(var n=this,a=[],r=0;r<arguments.length;r++)a[r]=arguments[r];i||(i=setTimeout((function(){t.apply(n,a),clearTimeout(i),i=null}),e))}}((function(){return i.resize()}),300)),window&&"function"==typeof window.MutationObserver&&new window.MutationObserver((function(){i.resize()})).observe(document.documentElement,{attributes:!0})}return t.prototype.resize=function(){var t,e;null===(e=(t=this.config).beforeResize)||void 0===e||e.call(t),this.setHTMLFontSize(),this.setDpr(),this.resetWidthAndHeight(),this.zoomCanvas()},t.prototype.initLucky=function(){if(this.resize(),!this.boxWidth||!this.boxHeight)return console.error("无法获取到宽度或高度")},t.prototype.handleClick=function(t){},t.prototype.setHTMLFontSize=function(){window&&(this.htmlFontSize=+window.getComputedStyle(document.documentElement).fontSize.slice(0,-2))},t.prototype.clearCanvas=function(){var t=[this.boxWidth,this.boxHeight],e=t[0],i=t[1];this.ctx.clearRect(-e,-i,2*e,2*i)},t.prototype.setDpr=function(){var t=this.config;t.dpr||(window?window.dpr=t.dpr=window.devicePixelRatio||1:t.dpr||console.error(t,"未传入 dpr 可能会导致绘制异常"))},t.prototype.resetWidthAndHeight=function(){var t=this.config,e=this.data,i=0,n=0;t.divElement&&(i=t.divElement.offsetWidth,n=t.divElement.offsetHeight),this.boxWidth=this.getLength(e.width||t.width)||i,this.boxHeight=this.getLength(e.height||t.height)||n,t.divElement&&(t.divElement.style.overflow="hidden",t.divElement.style.width=this.boxWidth+"px",t.divElement.style.height=this.boxHeight+"px")},t.prototype.zoomCanvas=function(){var t=this.config,e=this.ctx,i=t.canvasElement,n=t.dpr,a=[this.boxWidth*n,this.boxHeight*n],r=a[0],o=a[1];i&&(i.width=r,i.height=o,i.style.width=r+"px",i.style.height=o+"px",i.style["transform-origin"]="left top",i.style.transform="scale("+1/n+")",e.scale(n,n))},t.prototype.initWindowFunction=function(){var t=this.config;if(window)return this.rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},t.setTimeout=window.setTimeout,t.setInterval=window.setInterval,t.clearTimeout=window.clearTimeout,void(t.clearInterval=window.clearInterval);if(t.rAF)this.rAF=t.rAF;else if(t.setTimeout){var e=t.setTimeout;this.rAF=function(t){return e(t,16.7)}}else this.rAF=function(t){return setTimeout(t,16.7)}},t.prototype.isWeb=function(){return["WEB","UNI-H5","TARO-H5"].includes(this.config.flag)},t.prototype.loadImg=function(t,e,i){var n=this;return void 0===i&&(i="$resolve"),new Promise((function(a,r){if(t||r("=> '"+e.src+"' 不能为空或不合法"),"WEB"!==n.config.flag)return e[i]=a,void(e.$reject=r);var o=new Image;o.crossorigin="anonymous",o.onload=function(){return a(o)},o.onerror=function(){return r("=> '"+e.src+"' 图片加载失败")},o.src=t}))},t.prototype.drawImage=function(t,e){for(var i,n,a,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var s=this.config,l=s.flag,c=s.dpr;if(["WEB","MP-WX"].includes(l))a=e;else{if(!["UNI-H5","UNI-MP","TARO-H5","TARO-MP"].includes(l))return console.error("意料之外的 flag, 该平台尚未兼容!");a=e.path}var h=null===(n=(i=a.canvas||a).getContext)||void 0===n?void 0:n.call(i,"2d");if(h&&!this.isWeb()){r=r.map((function(t){return t*c}));var u=h.getImageData.apply(h,r.slice(0,4));t.putImageData.apply(t,st([u],r.slice(4,6)))}else{8===r.length&&(r=r.map((function(t,e){return e<4?t*c:t})));try{t.drawImage.apply(t,st([a],r))}catch(d){}}},t.prototype.computedWidthAndHeight=function(t,e,i,n){if(!e.width&&!e.height)return[t.width,t.height];if(e.width&&!e.height){var a=this.getLength(e.width,i);return[a,t.height*(a/t.width)]}if(!e.width&&e.height){var r=this.getLength(e.height,n);return[t.width*(r/t.height),r]}return[this.getLength(e.width,i),this.getLength(e.height,n)]},t.prototype.changeUnits=function(t,e){var i=this;void 0===e&&(e=1);var n=this.config;return Number(t.replace(/^([-]*[0-9.]*)([a-z%]*)$/,(function(t,a,r){var o={"%":function(t){return t*(e/100)},px:function(t){return 1*t},rem:function(t){return t*i.htmlFontSize},vw:function(t){return t/100*window.innerWidth}}[r];if(o)return o(a);var s=n.handleCssUnit||n.unitFunc;return s?s(a,r):a})))},t.prototype.getLength=function(t,e){return lt(t,"number")?t:lt(t,"string")?this.changeUnits(t,e):0},t.prototype.getOffsetX=function(t,e){return void 0===e&&(e=0),(e-t)/2},t.prototype.getOffscreenCanvas=function(t,e){if(!ct(this,"_offscreenCanvas")&&(window&&window.document&&"WEB"===this.config.flag?this._offscreenCanvas=document.createElement("canvas"):this._offscreenCanvas=this.config.offscreenCanvas,!this._offscreenCanvas))return console.error("离屏 Canvas 无法渲染!");var i=this.config.dpr,n=this._offscreenCanvas;n.width=(t||300)*i,n.height=(e||150)*i;var a=n.getContext("2d");return a.clearRect(0,0,t,e),a.scale(i,i),a.dpr=i,{_offscreenCanvas:n,_ctx:a}},t.prototype.$set=function(t,e,i){t&&"object"==typeof t&&xt(t,e,i)},t.prototype.$computed=function(t,e,i){var n=this;Object.defineProperty(t,e,{get:function(){return i.call(n)}})},t.prototype.$watch=function(t,e,i){void 0===i&&(i={}),"object"==typeof e&&(e=(i=e).handler);var n=new At(this,t,e,i);return i.immediate&&e.call(this,n.value),function(){}},t.version="1.7.26",t}(),St=function(t){return Math.PI/180*t},It=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=e[0],a=e[1],r=e[2],o=e[3],s=e[4],l=Math.min(r,o),c=Math.PI;s>l/2&&(s=l/2),t.beginPath(),t.moveTo(n+s,a),t.lineTo(n+s,a),t.lineTo(n+r-s,a),t.arc(n+r-s,a+s,s,-c/2,0),t.lineTo(n+r,a+o-s),t.arc(n+r-s,a+o-s,s,0,c/2),t.lineTo(n+s,a+o),t.arc(n+s,a+o-s,s,c/2,c),t.lineTo(n,a+s),t.arc(n+s,a+s,s,c,-c/2),t.closePath()},Lt=function(t,e,i,n){return t>=n&&(t=n),i*(t/=n)*t+e},Dt=function(t,e,i,n){return t>=n&&(t=n),-i*(t/=n)*(t-2)+e},_t=function(t){function e(e,i){var n,a=t.call(this,e,{width:i.width,height:i.height})||this;return a.blocks=[],a.prizes=[],a.buttons=[],a.defaultConfig={},a.defaultStyle={},a._defaultConfig={},a._defaultStyle={},a.Radius=0,a.prizeRadius=0,a.prizeDeg=0,a.prizeAng=0,a.rotateDeg=0,a.maxBtnRadius=0,a.startTime=0,a.endTime=0,a.stopDeg=0,a.endDeg=0,a.FPS=16.6,a.step=0,a.ImageCache=new Map,a.initData(i),a.initWatch(),a.initComputed(),null===(n=e.beforeCreate)||void 0===n||n.call(a),a.init(),a}return nt(e,t),e.prototype.resize=function(){var e,i;t.prototype.resize.call(this),this.Radius=Math.min(this.boxWidth,this.boxHeight)/2,this.ctx.translate(this.Radius,this.Radius),this.draw(),null===(i=(e=this.config).afterResize)||void 0===i||i.call(e)},e.prototype.initLucky=function(){this.Radius=0,this.prizeRadius=0,this.prizeDeg=0,this.prizeAng=0,this.rotateDeg=0,this.maxBtnRadius=0,this.startTime=0,this.endTime=0,this.stopDeg=0,this.endDeg=0,this.FPS=16.6,this.prizeFlag=-1,this.step=0,t.prototype.initLucky.call(this)},e.prototype.initData=function(t){this.$set(this,"width",t.width),this.$set(this,"height",t.height),this.$set(this,"blocks",t.blocks||[]),this.$set(this,"prizes",t.prizes||[]),this.$set(this,"buttons",t.buttons||[]),this.$set(this,"defaultConfig",t.defaultConfig||{}),this.$set(this,"defaultStyle",t.defaultStyle||{}),this.$set(this,"startCallback",t.start),this.$set(this,"endCallback",t.end)},e.prototype.initComputed=function(){var t=this;this.$computed(this,"_defaultConfig",(function(){return at({gutter:"0px",offsetDegree:0,speed:20,speedFunction:"quad",accelerationTime:2500,decelerationTime:2500,stopRange:0},t.defaultConfig)})),this.$computed(this,"_defaultStyle",(function(){return at({fontSize:"18px",fontColor:"#000",fontStyle:"sans-serif",fontWeight:"400",background:"rgba(0,0,0,0)",wordWrap:!0,lengthLimit:"90%"},t.defaultStyle)}))},e.prototype.initWatch=function(){var t=this;this.$watch("width",(function(e){t.data.width=e,t.resize()})),this.$watch("height",(function(e){t.data.height=e,t.resize()})),this.$watch("blocks",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("prizes",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("buttons",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("defaultConfig",(function(){return t.draw()}),{deep:!0}),this.$watch("defaultStyle",(function(){return t.draw()}),{deep:!0}),this.$watch("startCallback",(function(){return t.init()})),this.$watch("endCallback",(function(){return t.init()}))},e.prototype.init=function(){var t,e;return rt(this,void 0,void 0,(function(){var i;return ot(this,(function(n){switch(n.label){case 0:return this.initLucky(),i=this.config,null===(t=i.beforeInit)||void 0===t||t.call(this),this.draw(),this.draw(),[4,this.initImageCache()];case 1:return n.sent(),null===(e=i.afterInit)||void 0===e||e.call(this),[2]}}))}))},e.prototype.initImageCache=function(){var t=this;return new Promise((function(e){var i={blocks:t.blocks.map((function(t){return t.imgs})),prizes:t.prizes.map((function(t){return t.imgs})),buttons:t.buttons.map((function(t){return t.imgs}))};Object.keys(i).forEach((function(n){var a=i[n],r=[];a&&a.forEach((function(e,i){e&&e.forEach((function(e,a){r.push(t.loadAndCacheImg(n,i,a))}))})),Promise.all(r).then((function(){t.draw(),e()}))}))}))},e.prototype.handleClick=function(t){var e,i=this.ctx;i.beginPath(),i.arc(0,0,this.maxBtnRadius,0,2*Math.PI,!1),i.isPointInPath(t.offsetX,t.offsetY)&&0===this.step&&(null===(e=this.startCallback)||void 0===e||e.call(this,t))},e.prototype.loadAndCacheImg=function(t,e,i){return rt(this,void 0,void 0,(function(){var n=this;return ot(this,(function(a){return[2,new Promise((function(a,r){var o=n[t][e];if(o&&o.imgs){var s=o.imgs[i];s&&n.loadImg(s.src,s).then((function(t){return rt(n,void 0,void 0,(function(){return ot(this,(function(e){switch(e.label){case 0:return"function"!=typeof s.formatter?[3,2]:[4,Promise.resolve(s.formatter.call(this,t))];case 1:t=e.sent(),e.label=2;case 2:return this.ImageCache.set(s.src,t),a(),[2]}}))}))})).catch((function(n){console.error(t+"["+e+"].imgs["+i+"] "+n),r()}))}}))]}))}))},e.prototype.drawBlock=function(t,e,i){var n=this,a=this.ctx;ut(e.background)&&(a.beginPath(),a.fillStyle=e.background,a.arc(0,0,t,0,2*Math.PI,!1),a.fill()),e.imgs&&e.imgs.forEach((function(e,i){var r=n.ImageCache.get(e.src);if(r){var o=n.computedWidthAndHeight(r,e,2*t,2*t),s=o[0],l=o[1],c=[n.getOffsetX(s)+n.getLength(e.left,2*t),n.getLength(e.top,2*t)-t],h=c[0],u=c[1];a.save(),e.rotate&&a.rotate(St(n.rotateDeg)),n.drawImage(a,r,h,u,s,l),a.restore()}}))},e.prototype.draw=function(){var t,e,i=this,n=this,a=n.config,r=n.ctx,o=n._defaultConfig,s=n._defaultStyle;null===(t=a.beforeDraw)||void 0===t||t.call(this,r),r.clearRect(-this.Radius,-this.Radius,2*this.Radius,2*this.Radius),this.prizeRadius=this.blocks.reduce((function(t,e,n){return i.drawBlock(t,e,n),t-i.getLength(e.padding&&e.padding.split(" ")[0])}),this.Radius),this.prizeDeg=360/this.prizes.length,this.prizeAng=St(this.prizeDeg);var l=this.prizeRadius*Math.sin(this.prizeAng/2)*2,c=St(this.rotateDeg-90+this.prizeDeg/2+o.offsetDegree),h=function(t,e){return i.getOffsetX(r.measureText(e).width)+i.getLength(t.left,l)},u=function(t,e,n){var a=t.lineHeight||s.lineHeight||t.fontSize||s.fontSize;return i.getLength(t.top,e)+(n+1)*i.getLength(a)};r.save(),this.prizes.forEach((function(t,e){var n=c+e*i.prizeAng,a=i.prizeRadius-i.maxBtnRadius,d=t.background||s.background;ut(d)&&(r.fillStyle=d,function(t,e,i,n,a,r){t.beginPath();var o,s,l=St(90/Math.PI/i*r),c=n+l,h=a-l;t.arc(0,0,i,c,h,!1),t.lineTo.apply(t,(o=(n+a)/2,s=r/2/Math.abs(Math.sin((n-a)/2)),[+(Math.cos(o)*s).toFixed(8),+(Math.sin(o)*s).toFixed(8)])),t.closePath()}(r,i.maxBtnRadius,i.prizeRadius,n-i.prizeAng/2,n+i.prizeAng/2,i.getLength(o.gutter)),r.fill());var f=Math.cos(n)*i.prizeRadius,p=Math.sin(n)*i.prizeRadius;r.translate(f,p),r.rotate(n+St(90)),t.imgs&&t.imgs.forEach((function(t,e){var n=i.ImageCache.get(t.src);if(n){var o=i.computedWidthAndHeight(n,t,i.prizeAng*i.prizeRadius,a),s=o[0],c=o[1],h=[i.getOffsetX(s)+i.getLength(t.left,l),i.getLength(t.top,a)],u=h[0],d=h[1];i.drawImage(r,n,u,d,s,c)}})),t.fonts&&t.fonts.forEach((function(t){var e=t.fontColor||s.fontColor,n=t.fontWeight||s.fontWeight,l=i.getLength(t.fontSize||s.fontSize),c=t.fontStyle||s.fontStyle,d=ct(t,"wordWrap")?t.wordWrap:s.wordWrap,f=t.lengthLimit||s.lengthLimit,p=t.lineClamp||s.lineClamp;r.fillStyle=e,r.font=n+" "+(l>>0)+"px "+c;var g=String(t.text);(d?pt(r,ht(g),(function(e){var n=(i.prizeRadius-u(t,a,e.length))*Math.tan(i.prizeAng/2)*2-i.getLength(o.gutter);return i.getLength(f,n)}),p):g.split("\n")).filter((function(t){return!!t})).forEach((function(e,i){r.fillText(e,h(t,e),u(t,a,i))}))})),r.rotate(St(360)-n-St(90)),r.translate(-f,-p)})),r.restore(),this.buttons.forEach((function(t,e){var n=i.getLength(t.radius,i.prizeRadius);i.maxBtnRadius=Math.max(i.maxBtnRadius,n),ut(t.background)&&(r.beginPath(),r.fillStyle=t.background,r.arc(0,0,n,0,2*Math.PI,!1),r.fill()),t.pointer&&ut(t.background)&&(r.beginPath(),r.fillStyle=t.background,r.moveTo(-n,0),r.lineTo(n,0),r.lineTo(0,2*-n),r.closePath(),r.fill()),t.imgs&&t.imgs.forEach((function(t,e){var a=i.ImageCache.get(t.src);if(a){var o=i.computedWidthAndHeight(a,t,2*n,2*n),s=o[0],l=o[1],c=[i.getOffsetX(s)+i.getLength(t.left,n),i.getLength(t.top,n)],h=c[0],u=c[1];i.drawImage(r,a,h,u,s,l)}})),t.fonts&&t.fonts.forEach((function(t){var e=t.fontColor||s.fontColor,a=t.fontWeight||s.fontWeight,o=i.getLength(t.fontSize||s.fontSize),l=t.fontStyle||s.fontStyle;r.fillStyle=e,r.font=a+" "+(o>>0)+"px "+l,String(t.text).split("\n").forEach((function(e,i){r.fillText(e,h(t,e),u(t,n,i))}))}))})),null===(e=a.afterDraw)||void 0===e||e.call(this,r)},e.prototype.carveOnGunwaleOfAMovingBoat=function(){var t=this,e=t._defaultConfig,i=t.prizeFlag,n=t.prizeDeg,a=t.rotateDeg;this.endTime=Date.now();for(var r=this.stopDeg=a,o=e.speed,s=(Math.random()*n-n/2)*this.getLength(e.stopRange),l=0,c=0,h=0;++l;){var u=360*l-i*n-a-e.offsetDegree+s-n/2,d=Dt(this.FPS,r,u,e.decelerationTime)-r;if(d>o){this.endDeg=o-c>d-o?u:h;break}h=u,c=d}},e.prototype.play=function(){var t,e;0===this.step&&(this.startTime=Date.now(),this.prizeFlag=void 0,this.step=1,null===(e=(t=this.config).afterStart)||void 0===e||e.call(t),this.run())},e.prototype.stop=function(t){if(0!==this.step&&3!==this.step){if(!t&&0!==t){var e=this.prizes.map((function(t){return t.range}));t=ft(e)}t<0?(this.step=0,this.prizeFlag=-1):(this.step=2,this.prizeFlag=t%this.prizes.length)}},e.prototype.run=function(t){var e;void 0===t&&(t=0);var i=this,n=i.rAF,a=i.step,r=i.prizeFlag,o=i._defaultConfig,s=o.accelerationTime,l=o.decelerationTime,c=o.speed;if(0!==a){if(-1!==r){3!==a||this.endDeg||this.carveOnGunwaleOfAMovingBoat();var h=Date.now()-this.startTime,u=Date.now()-this.endTime,d=this.rotateDeg;if(1===a||h<s){this.FPS=h/t;var f=Lt(h,0,c,s);f===c&&(this.step=2),d+=f%360}else 2===a?(d+=c%360,void 0!==r&&r>=0&&(this.step=3,this.stopDeg=0,this.endDeg=0)):3===a?(d=Dt(u,this.stopDeg,this.endDeg,l),u>=l&&(this.step=0)):this.stop(-1);this.rotateDeg=d,this.draw(),n(this.run.bind(this,t+1))}}else null===(e=this.endCallback)||void 0===e||e.call(this,this.prizes.find((function(t,e){return e===r}))||{})},e.prototype.conversionAxis=function(t,e){var i=this.config;return[t/i.dpr-this.Radius,e/i.dpr-this.Radius]},e}(zt);!function(t){function e(e,i){var n,a=t.call(this,e,{width:i.width,height:i.height})||this;return a.rows=3,a.cols=3,a.blocks=[],a.prizes=[],a.buttons=[],a.defaultConfig={},a.defaultStyle={},a.activeStyle={},a._defaultConfig={},a._defaultStyle={},a._activeStyle={},a.cellWidth=0,a.cellHeight=0,a.startTime=0,a.endTime=0,a.currIndex=0,a.stopIndex=0,a.endIndex=0,a.demo=!1,a.timer=0,a.FPS=16.6,a.step=0,a.prizeFlag=-1,a.cells=[],a.ImageCache=new Map,a.initData(i),a.initWatch(),a.initComputed(),null===(n=e.beforeCreate)||void 0===n||n.call(a),a.init(),a}nt(e,t),e.prototype.resize=function(){var e,i;t.prototype.resize.call(this),this.draw(),null===(i=(e=this.config).afterResize)||void 0===i||i.call(e)},e.prototype.initLucky=function(){this.cellWidth=0,this.cellHeight=0,this.startTime=0,this.endTime=0,this.currIndex=0,this.stopIndex=0,this.endIndex=0,this.demo=!1,this.timer=0,this.FPS=16.6,this.prizeFlag=-1,this.step=0,t.prototype.initLucky.call(this)},e.prototype.initData=function(t){this.$set(this,"width",t.width),this.$set(this,"height",t.height),this.$set(this,"rows",Number(t.rows)||3),this.$set(this,"cols",Number(t.cols)||3),this.$set(this,"blocks",t.blocks||[]),this.$set(this,"prizes",t.prizes||[]),this.$set(this,"buttons",t.buttons||[]),this.$set(this,"button",t.button),this.$set(this,"defaultConfig",t.defaultConfig||{}),this.$set(this,"defaultStyle",t.defaultStyle||{}),this.$set(this,"activeStyle",t.activeStyle||{}),this.$set(this,"startCallback",t.start),this.$set(this,"endCallback",t.end)},e.prototype.initComputed=function(){var t=this;this.$computed(this,"_defaultConfig",(function(){var e=at({gutter:5,speed:20,accelerationTime:2500,decelerationTime:2500},t.defaultConfig);return e.gutter=t.getLength(e.gutter),e.speed=e.speed/40,e})),this.$computed(this,"_defaultStyle",(function(){return at({borderRadius:20,fontColor:"#000",fontSize:"18px",fontStyle:"sans-serif",fontWeight:"400",background:"rgba(0,0,0,0)",shadow:"",wordWrap:!0,lengthLimit:"90%"},t.defaultStyle)})),this.$computed(this,"_activeStyle",(function(){return at({background:"#ffce98",shadow:""},t.activeStyle)}))},e.prototype.initWatch=function(){var t=this;this.$watch("width",(function(e){t.data.width=e,t.resize()})),this.$watch("height",(function(e){t.data.height=e,t.resize()})),this.$watch("blocks",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("prizes",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("buttons",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("rows",(function(){return t.init()})),this.$watch("cols",(function(){return t.init()})),this.$watch("defaultConfig",(function(){return t.draw()}),{deep:!0}),this.$watch("defaultStyle",(function(){return t.draw()}),{deep:!0}),this.$watch("activeStyle",(function(){return t.draw()}),{deep:!0}),this.$watch("startCallback",(function(){return t.init()})),this.$watch("endCallback",(function(){return t.init()}))},e.prototype.init=function(){var t,e;return rt(this,void 0,void 0,(function(){var i;return ot(this,(function(n){switch(n.label){case 0:return this.initLucky(),i=this.config,null===(t=i.beforeInit)||void 0===t||t.call(this),this.draw(),[4,this.initImageCache()];case 1:return n.sent(),null===(e=i.afterInit)||void 0===e||e.call(this),[2]}}))}))},e.prototype.initImageCache=function(){var t=this;return new Promise((function(e){var i=t.buttons.map((function(t){return t.imgs}));t.button&&i.push(t.button.imgs);var n={blocks:t.blocks.map((function(t){return t.imgs})),prizes:t.prizes.map((function(t){return t.imgs})),buttons:i};Object.keys(n).forEach((function(i){var a=n[i],r=[];a&&a.forEach((function(e,n){e&&e.forEach((function(e,a){r.push(t.loadAndCacheImg(i,n,a))}))})),Promise.all(r).then((function(){t.draw(),e()}))}))}))},e.prototype.handleClick=function(t){var e=this,i=this.ctx;st(st([],this.buttons),[this.button]).forEach((function(n){var a;if(n){var r=e.getGeometricProperty([n.x,n.y,n.col||1,n.row||1]),o=r[0],s=r[1],l=r[2],c=r[3];i.beginPath(),i.rect(o,s,l,c),i.isPointInPath(t.offsetX,t.offsetY)&&0===e.step&&("function"==typeof n.callback&&n.callback.call(e,n),null===(a=e.startCallback)||void 0===a||a.call(e,t,n))}}))},e.prototype.loadAndCacheImg=function(t,e,i){return rt(this,void 0,void 0,(function(){var n=this;return ot(this,(function(a){return[2,new Promise((function(a,r){var o=n[t][e];if("buttons"===t&&!n.buttons.length&&n.button&&(o=n.button),o&&o.imgs){var s=o.imgs[i];if(s){var l=[n.loadImg(s.src,s),s.activeSrc&&n.loadImg(s.activeSrc,s,"$activeResolve")];Promise.all(l).then((function(t){var e=t[0],i=t[1];return rt(n,void 0,void 0,(function(){var t;return ot(this,(function(n){switch(n.label){case 0:return"function"!=typeof(t=s.formatter)?[3,3]:[4,Promise.resolve(t.call(this,e))];case 1:return e=n.sent(),i?[4,Promise.resolve(t.call(this,i))]:[3,3];case 2:i=n.sent(),n.label=3;case 3:return this.ImageCache.set(s.src,e),i&&this.ImageCache.set(s.activeSrc,i),a(),[2]}}))}))})).catch((function(n){console.error(t+"["+e+"].imgs["+i+"] "+n),r()}))}}}))]}))}))},e.prototype.draw=function(){var t,e,i=this,n=this,a=n.config,r=n.ctx,o=n._defaultConfig,s=n._defaultStyle,l=n._activeStyle;null===(t=a.beforeDraw)||void 0===t||t.call(this,r),r.clearRect(0,0,this.boxWidth,this.boxHeight),this.cells=st(st([],this.prizes),this.buttons),this.button&&this.cells.push(this.button),this.cells.forEach((function(t){t.col=t.col||1,t.row=t.row||1})),this.prizeArea=this.blocks.reduce((function(t,e,n){var a=t.x,o=t.y,s=t.w,l=t.h,c=dt(e,i.getLength.bind(i)),h=c[0],u=c[1],d=c[2],f=c[3],p=e.borderRadius?i.getLength(e.borderRadius):0,g=e.background;return ut(g)&&(r.fillStyle=i.handleBackground(a,o,s,l,g),It(r,a,o,s,l,p),r.fill()),e.imgs&&e.imgs.forEach((function(t,e){var n=i.ImageCache.get(t.src);if(n){var c=i.computedWidthAndHeight(n,t,s,l),h=c[0],u=c[1],d=[i.getOffsetX(h,s)+i.getLength(t.left,s),i.getLength(t.top,l)],f=d[0],p=d[1];i.drawImage(r,n,a+f,o+p,h,u)}})),{x:a+d,y:o+h,w:s-d-f,h:l-h-u}}),{x:0,y:0,w:this.boxWidth,h:this.boxHeight}),this.cellWidth=(this.prizeArea.w-o.gutter*(this.cols-1))/this.cols,this.cellHeight=(this.prizeArea.h-o.gutter*(this.rows-1))/this.rows,this.cells.forEach((function(t,e){var n=i.getGeometricProperty([t.x,t.y,t.col,t.row]),o=n[0],c=n[1],h=n[2],u=n[3],d=!1;(void 0===i.prizeFlag||i.prizeFlag>-1)&&(d=e===i.currIndex%i.prizes.length>>0);var f=d?l.background:t.background||s.background;if(ut(f)){var p=(d?l.shadow:t.shadow||s.shadow).replace(/px/g,"").split(",")[0].split(" ").map((function(t,e){return e<3?Number(t):t}));4===p.length&&(r.shadowColor=p[3],r.shadowOffsetX=p[0]*a.dpr,r.shadowOffsetY=p[1]*a.dpr,r.shadowBlur=p[2],p[0]>0?h-=p[0]:(h+=p[0],o-=p[0]),p[1]>0?u-=p[1]:(u+=p[1],c-=p[1])),r.fillStyle=i.handleBackground(o,c,h,u,f);var g=i.getLength(t.borderRadius?t.borderRadius:s.borderRadius);It(r,o,c,h,u,g),r.fill(),r.shadowColor="rgba(0, 0, 0, 0)",r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=0}e>=i.prizes.length&&(e-=i.prizes.length),t.imgs&&t.imgs.forEach((function(t,e){var n=i.ImageCache.get(t.src),a=i.ImageCache.get(t.activeSrc);if(n){var s=d&&a||n;if(s){var l=i.computedWidthAndHeight(s,t,h,u),f=l[0],p=l[1],g=[o+i.getOffsetX(f,h)+i.getLength(t.left,h),c+i.getLength(t.top,u)],m=g[0],y=g[1];i.drawImage(r,s,m,y,f,p)}}})),t.fonts&&t.fonts.forEach((function(t){var e=d&&l.fontStyle?l.fontStyle:t.fontStyle||s.fontStyle,n=d&&l.fontWeight?l.fontWeight:t.fontWeight||s.fontWeight,a=d&&l.fontSize?i.getLength(l.fontSize):i.getLength(t.fontSize||s.fontSize),f=d&&l.lineHeight?l.lineHeight:t.lineHeight||s.lineHeight||t.fontSize||s.fontSize,p=ct(t,"wordWrap")?t.wordWrap:s.wordWrap,g=t.lengthLimit||s.lengthLimit,m=t.lineClamp||s.lineClamp;r.font=n+" "+(a>>0)+"px "+e,r.fillStyle=d&&l.fontColor?l.fontColor:t.fontColor||s.fontColor;var y=[],v=String(t.text);if(p){var w=i.getLength(g,h);y=pt(r,ht(v),(function(){return w}),m)}else y=v.split("\n");y.forEach((function(e,n){r.fillText(e,o+i.getOffsetX(r.measureText(e).width,h)+i.getLength(t.left,h),c+i.getLength(t.top,u)+(n+1)*i.getLength(f))}))}))})),null===(e=a.afterDraw)||void 0===e||e.call(this,r)},e.prototype.handleBackground=function(t,e,i,n,a){var r=this.ctx;return a.includes("linear-gradient")&&(a=function(t,e,i,n,a,r){var o=/linear-gradient\((.+)\)/.exec(r)[1].split(",").map((function(t){return t.trim()})),s=o.shift(),l=[0,0,0,0];if(s.includes("deg")){var c=function(t){return Math.tan(t/180*Math.PI)};(s=s.slice(0,-3)%360)>=0&&s<45?l=[e,i+a,e+n,i+a-n*c(s-0)]:s>=45&&s<90?l=[e,i+a,e+n-a*c(s-45),i]:s>=90&&s<135?l=[e+n,i+a,e+n-a*c(s-90),i]:s>=135&&s<180?l=[e+n,i+a,e,i+n*c(s-135)]:s>=180&&s<225?l=[e+n,i,e,i+n*c(s-180)]:s>=225&&s<270?l=[e+n,i,e+a*c(s-225),i+a]:s>=270&&s<315?l=[e,i,e+a*c(s-270),i+a]:s>=315&&s<360&&(l=[e,i,e+n,i+a-n*c(s-315)])}else s.includes("top")?l=[e,i+a,e,i]:s.includes("bottom")?l=[e,i,e,i+a]:s.includes("left")?l=[e+n,i,e,i]:s.includes("right")&&(l=[e,i,e+n,i]);var h=t.createLinearGradient.apply(t,l.map((function(t){return t>>0})));return o.reduce((function(t,e,i){var n=e.split(" ");return 1===n.length?t.addColorStop(i,n[0]):2===n.length&&t.addColorStop.apply(t,n),t}),h)}(r,t,e,i,n,a)),a},e.prototype.carveOnGunwaleOfAMovingBoat=function(){var t=this,e=t._defaultConfig,i=t.prizeFlag,n=t.currIndex;this.endTime=Date.now();for(var a=this.stopIndex=n,r=e.speed,o=0,s=0,l=0;++o;){var c=this.prizes.length*o+i-a,h=Dt(this.FPS,a,c,e.decelerationTime)-a;if(h>r){this.endIndex=r-s>h-r?c:l;break}l=c,s=h}},e.prototype.play=function(){var t,e;0===this.step&&(this.startTime=Date.now(),this.prizeFlag=void 0,this.step=1,null===(e=(t=this.config).afterStart)||void 0===e||e.call(t),this.run())},e.prototype.stop=function(t){if(0!==this.step&&3!==this.step){if(!t&&0!==t){var e=this.prizes.map((function(t){return t.range}));t=ft(e)}t<0?(this.step=0,this.prizeFlag=-1):(this.step=2,this.prizeFlag=t%this.prizes.length)}},e.prototype.run=function(t){var e;void 0===t&&(t=0);var i=this,n=i.rAF,a=i.step,r=i.prizes,o=i.prizeFlag,s=i._defaultConfig,l=s.accelerationTime,c=s.decelerationTime,h=s.speed;if(0!==a){if(-1!==o){3!==a||this.endIndex||this.carveOnGunwaleOfAMovingBoat();var u=Date.now()-this.startTime,d=Date.now()-this.endTime,f=this.currIndex;if(1===a||u<l){this.FPS=u/t;var p=Lt(u,.1,h-.1,l);p===h&&(this.step=2),f+=p%r.length}else 2===a?(f+=h%r.length,void 0!==o&&o>=0&&(this.step=3,this.stopIndex=0,this.endIndex=0)):3===a?(f=Dt(d,this.stopIndex,this.endIndex,c),d>=c&&(this.step=0)):this.stop(-1);this.currIndex=f,this.draw(),n(this.run.bind(this,t+1))}}else null===(e=this.endCallback)||void 0===e||e.call(this,this.prizes.find((function(t,e){return e===o}))||{})},e.prototype.getGeometricProperty=function(t){var e=t[0],i=t[1],n=t[2],a=void 0===n?1:n,r=t[3],o=void 0===r?1:r,s=this.cellWidth,l=this.cellHeight,c=this._defaultConfig.gutter,h=[this.prizeArea.x+(s+c)*e,this.prizeArea.y+(l+c)*i];return a&&o&&h.push(s*a+c*(a-1),l*o+c*(o-1)),h},e.prototype.conversionAxis=function(t,e){var i=this.config;return[t/i.dpr,e/i.dpr]}}(zt),function(t){function e(e,i){var n,a=t.call(this,e,{width:i.width,height:i.height})||this;return a.blocks=[],a.prizes=[],a.slots=[],a.defaultConfig={},a._defaultConfig={},a.defaultStyle={},a._defaultStyle={},a.endCallback=function(){},a.cellWidth=0,a.cellHeight=0,a.cellAndSpacing=0,a.widthAndSpacing=0,a.heightAndSpacing=0,a.FPS=16.6,a.scroll=[],a.stopScroll=[],a.endScroll=[],a.startTime=0,a.endTime=0,a.step=0,a.prizeFlag=void 0,a.ImageCache=new Map,a.initData(i),a.initWatch(),a.initComputed(),null===(n=e.beforeCreate)||void 0===n||n.call(a),a.init(),a}nt(e,t),e.prototype.resize=function(){var e,i;t.prototype.resize.call(this),this.draw(),null===(i=(e=this.config).afterResize)||void 0===i||i.call(e)},e.prototype.initLucky=function(){this.cellWidth=0,this.cellHeight=0,this.cellAndSpacing=0,this.widthAndSpacing=0,this.heightAndSpacing=0,this.FPS=16.6,this.scroll=[],this.stopScroll=[],this.endScroll=[],this.startTime=0,this.endTime=0,this.prizeFlag=void 0,this.step=0,t.prototype.initLucky.call(this)},e.prototype.initData=function(t){this.$set(this,"width",t.width),this.$set(this,"height",t.height),this.$set(this,"blocks",t.blocks||[]),this.$set(this,"prizes",t.prizes||[]),this.$set(this,"slots",t.slots||[]),this.$set(this,"defaultConfig",t.defaultConfig||{}),this.$set(this,"defaultStyle",t.defaultStyle||{}),this.$set(this,"endCallback",t.end)},e.prototype.initComputed=function(){var t=this;this.$computed(this,"_defaultConfig",(function(){var e=at({mode:"vertical",rowSpacing:0,colSpacing:5,speed:20,direction:1,accelerationTime:2500,decelerationTime:2500},t.defaultConfig);return e.rowSpacing=t.getLength(e.rowSpacing),e.colSpacing=t.getLength(e.colSpacing),e})),this.$computed(this,"_defaultStyle",(function(){return at({borderRadius:0,fontColor:"#000",fontSize:"18px",fontStyle:"sans-serif",fontWeight:"400",background:"rgba(0,0,0,0)",wordWrap:!0,lengthLimit:"90%"},t.defaultStyle)}))},e.prototype.initWatch=function(){var t=this;this.$watch("width",(function(e){t.data.width=e,t.resize()})),this.$watch("height",(function(e){t.data.height=e,t.resize()})),this.$watch("blocks",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("prizes",(function(e){t.initImageCache()}),{deep:!0}),this.$watch("slots",(function(e){t.drawOffscreenCanvas(),t.draw()}),{deep:!0}),this.$watch("defaultConfig",(function(){return t.draw()}),{deep:!0}),this.$watch("defaultStyle",(function(){return t.draw()}),{deep:!0}),this.$watch("endCallback",(function(){return t.init()}))},e.prototype.init=function(){var t,e;return rt(this,void 0,void 0,(function(){var i;return ot(this,(function(n){switch(n.label){case 0:return this.initLucky(),i=this.config,null===(t=i.beforeInit)||void 0===t||t.call(this),this.drawOffscreenCanvas(),this.draw(),[4,this.initImageCache()];case 1:return n.sent(),null===(e=i.afterInit)||void 0===e||e.call(this),[2]}}))}))},e.prototype.initImageCache=function(){var t=this;return new Promise((function(e){var i={blocks:t.blocks.map((function(t){return t.imgs})),prizes:t.prizes.map((function(t){return t.imgs}))};Object.keys(i).forEach((function(n){var a=i[n],r=[];a&&a.forEach((function(e,i){e&&e.forEach((function(e,a){r.push(t.loadAndCacheImg(n,i,a))}))})),Promise.all(r).then((function(){t.drawOffscreenCanvas(),t.draw(),e()}))}))}))},e.prototype.loadAndCacheImg=function(t,e,i){return rt(this,void 0,void 0,(function(){var n=this;return ot(this,(function(a){return[2,new Promise((function(a,r){var o=n[t][e];if(o&&o.imgs){var s=o.imgs[i];s&&n.loadImg(s.src,s).then((function(t){return rt(n,void 0,void 0,(function(){return ot(this,(function(e){switch(e.label){case 0:return"function"!=typeof s.formatter?[3,2]:[4,Promise.resolve(s.formatter.call(this,t))];case 1:t=e.sent(),e.label=2;case 2:return this.ImageCache.set(s.src,t),a(),[2]}}))}))})).catch((function(n){console.error(t+"["+e+"].imgs["+i+"] "+n),r()}))}}))]}))}))},e.prototype.drawOffscreenCanvas=function(){var t=this,e=this._defaultConfig,i=this._defaultStyle,n=this.drawBlocks(),a=n.w,r=n.h,o=this.prizes.length,s=this.displacementWidthOrHeight(),l=s.cellWidth,c=s.cellHeight,h=s.widthAndSpacing,u=s.heightAndSpacing,d=new Array(o).fill(void 0).map((function(t,e){return e})),f=0,p=0;this.slots.forEach((function(e,i){void 0===t.scroll[i]&&(t.scroll[i]=0),e.order=e.order||d;var n=e.order.length;f=Math.max(f,a+h*n),p=Math.max(p,r+u*n)}));var g=this.getOffscreenCanvas(f,p),m=g._offscreenCanvas,y=g._ctx;this._offscreenCanvas=m,this.slots.forEach((function(n,a){var r=l*a,o=c*a,s=0,d=function(t,e){for(var i={},n=[],a=0;a<t.length;a++)i[a]=t[a];for(a=0;a<e.length;a++){var r=i[e[a]];r&&(n[a]=r)}return n}(t.prizes,n.order);if(d.length){d.forEach((function(a,d){if(a){n.order[d];var f=h*d+e.colSpacing/2,p=u*d+e.rowSpacing/2,g=t.displacement([r,p,u],[f,o,h]),m=g[0],v=g[1],w=g[2];s+=w;var b=a.background||i.background;if(ut(b)){var k=t.getLength(ct(a,"borderRadius")?a.borderRadius:i.borderRadius);It(y,m,v,l,l,k),y.fillStyle=b,y.fill()}a.imgs&&a.imgs.forEach((function(e,i){var n=t.ImageCache.get(e.src);if(n){var a=t.computedWidthAndHeight(n,e,l,c),r=a[0],o=a[1],s=[m+t.getOffsetX(r,l)+t.getLength(e.left,l),v+t.getLength(e.top,c)],h=s[0],u=s[1];t.drawImage(y,n,h,u,r,o)}})),a.fonts&&a.fonts.forEach((function(e){var n=e.fontStyle||i.fontStyle,a=e.fontWeight||i.fontWeight,r=t.getLength(e.fontSize||i.fontSize),o=e.lineHeight||i.lineHeight||e.fontSize||i.fontSize,s=ct(e,"wordWrap")?e.wordWrap:i.wordWrap,h=e.lengthLimit||i.lengthLimit,u=e.lineClamp||i.lineClamp;y.font=a+" "+(r>>0)+"px "+n,y.fillStyle=e.fontColor||i.fontColor;var d=[],f=String(e.text);if(s){var p=t.getLength(h,l);d=pt(y,ht(f),(function(){return p}),u)}else d=f.split("\n");d.forEach((function(i,n){y.fillText(i,m+t.getOffsetX(y.measureText(i).width,l)+t.getLength(e.left,l),v+t.getLength(e.top,c)+(n+1)*t.getLength(o))}))}))}}));for(var f=t.displacement([r,0,l,s],[0,o,s,c]),g=f[0],v=f[1],w=f[2],b=f[3],k=s;k<p+s;){var x=t.displacement([g,k],[k,v]),C=x[0],A=x[1];t.drawImage(y,m,g,v,w,b,C,A,w,b),k+=s}}}))},e.prototype.drawBlocks=function(){var t=this,e=this;e.config;var i=e.ctx;e._defaultConfig;var n=e._defaultStyle;return this.prizeArea=this.blocks.reduce((function(e,a,r){var o=e.x,s=e.y,l=e.w,c=e.h,h=dt(a,t.getLength.bind(t)),u=h[0],d=h[1],f=h[2],p=h[3],g=a.borderRadius?t.getLength(a.borderRadius):0,m=a.background||n.background;return ut(m)&&(It(i,o,s,l,c,g),i.fillStyle=m,i.fill()),a.imgs&&a.imgs.forEach((function(e,n){var a=t.ImageCache.get(e.src);if(a){var r=t.computedWidthAndHeight(a,e,l,c),h=r[0],u=r[1],d=[t.getOffsetX(h,l)+t.getLength(e.left,l),t.getLength(e.top,c)],f=d[0],p=d[1];t.drawImage(i,a,o+f,s+p,h,u)}})),{x:o+f,y:s+u,w:l-f-p,h:c-u-d}}),{x:0,y:0,w:this.boxWidth,h:this.boxHeight})},e.prototype.draw=function(){var t,e=this,i=this,n=i.config,a=i.ctx;i._defaultConfig,i._defaultStyle,null===(t=n.beforeDraw)||void 0===t||t.call(this,a),a.clearRect(0,0,this.boxWidth,this.boxHeight);var r=this.drawBlocks(),o=r.x,s=r.y,l=r.w,c=r.h;if(this._offscreenCanvas){var h=this,u=h.cellWidth,d=h.cellHeight,f=h.cellAndSpacing,p=h.widthAndSpacing,g=h.heightAndSpacing;this.slots.forEach((function(t,i){var n=f*t.order.length,r=e.displacement(-(c-g)/2,-(l-p)/2),h=e.scroll[i]+r;h<0&&(h=h%n+n),h>n&&(h%=n);var m=e.displacement([u*i,h,u,c],[h,d*i,l,d]),y=m[0],v=m[1],w=m[2],b=m[3],k=e.displacement([o+p*i,s,u,c],[o,s+g*i,l,d]),x=k[0],C=k[1],A=k[2],z=k[3];e.drawImage(a,e._offscreenCanvas,y,v,w,b,x,C,A,z)}))}},e.prototype.carveOnGunwaleOfAMovingBoat=function(){var t=this,e=this,i=e._defaultConfig,n=e.prizeFlag,a=e.cellAndSpacing;this.endTime=Date.now(),this.slots.forEach((function(e,r){var o=e.order;if(o.length)for(var s=e.speed||i.speed,l=e.direction||i.direction,c=o.findIndex((function(t){return t===n[r]})),h=a*o.length,u=t.stopScroll[r]=t.scroll[r],d=0;++d;){var f=a*c+h*d*l-u,p=Dt(t.FPS,u,f,i.decelerationTime)-u;if(Math.abs(p)>s){t.endScroll[r]=f;break}}}))},e.prototype.play=function(){var t,e;0===this.step&&(this.startTime=Date.now(),this.prizeFlag=void 0,this.step=1,null===(e=(t=this.config).afterStart)||void 0===e||e.call(t),this.run())},e.prototype.stop=function(t){var e;if(0!==this.step&&3!==this.step){if("number"==typeof t)this.prizeFlag=new Array(this.slots.length).fill(t);else{if(!lt(t,"array"))return this.stop(-1),console.error("stop() 无法识别的参数类型 "+typeof t);if(t.length!==this.slots.length)return this.stop(-1),console.error("stop(["+t+"]) 参数长度的不正确");this.prizeFlag=t}(null===(e=this.prizeFlag)||void 0===e?void 0:e.includes(-1))?(this.prizeFlag=[],this.step=0):this.step=2}},e.prototype.run=function(t){var e,i,n=this;void 0===t&&(t=0);var a=this,r=a.rAF,o=a.step,s=a.prizeFlag,l=a._defaultConfig,c=a.cellAndSpacing,h=a.slots,u=l.accelerationTime,d=l.decelerationTime;if(0!==this.step||(null==s?void 0:s.length)!==h.length){if(void 0===s||s.length){3!==this.step||this.endScroll.length||this.carveOnGunwaleOfAMovingBoat();var f=Date.now()-this.startTime,p=Date.now()-this.endTime;h.forEach((function(e,i){var a=e.order;if(a&&a.length){var r=c*a.length,g=Math.abs(e.speed||l.speed),m=e.direction||l.direction,y=0,v=n.scroll[i];if(1===o||f<u){n.FPS=f/t;var w=Lt(f,0,g,u);w===g&&(n.step=2),y=(v+w*m)%r}else if(2===o)y=(v+g*m)%r,(null==s?void 0:s.length)===h.length&&(n.step=3,n.stopScroll=[],n.endScroll=[]);else if(3===o&&p){var b=n.stopScroll[i],k=n.endScroll[i];y=Dt(p,b,k,d),p>=d&&(n.step=0)}n.scroll[i]=y}})),this.draw(),r(this.run.bind(this,t+1))}}else{for(var g=s[0],m=0;m<h.length;m++){var y=h[m],v=s[m];if(!(null===(e=y.order)||void 0===e?void 0:e.includes(v))||g!==v){g=-1;break}}null===(i=this.endCallback)||void 0===i||i.call(this,this.prizes.find((function(t,e){return e===g}))||void 0)}},e.prototype.displacement=function(t,e){return"horizontal"===this._defaultConfig.mode?e:t},e.prototype.displacementWidthOrHeight=function(){var t=this._defaultConfig.mode,e=this.slots.length,i=this._defaultConfig,n=i.colSpacing,a=i.rowSpacing,r=this.prizeArea||this.drawBlocks();r.x,r.y;var o,s,l=r.w,c=r.h,h=0,u=0;return"horizontal"===t?(u=this.cellHeight=(c-a*(e-1))/e,h=this.cellWidth=u):(h=this.cellWidth=(l-n*(e-1))/e,u=this.cellHeight=h),o=this.widthAndSpacing=this.cellWidth+n,s=this.heightAndSpacing=this.cellHeight+a,this.cellAndSpacing="horizontal"===t?o:s,{cellWidth:h,cellHeight:u,widthAndSpacing:o,heightAndSpacing:s}}}(zt);var Tt=K({name:"lucky-wheel",data:()=>({imgSrc:"",myLucky:null,canvas:null,isShow:!1,boxWidth:100,boxHeight:100,btnWidth:0,btnHeight:0,dpr:1}),props:{width:{type:String,default:"600rpx"},height:{type:String,default:"600rpx"},blocks:{type:Array,default:()=>[]},prizes:{type:Array,default:()=>[]},buttons:{type:Array,default:()=>[]},defaultConfig:{type:Object,default:()=>({})},defaultStyle:{type:Object,default:()=>({})}},mounted(){this.initLucky()},watch:{blocks(t){this.myLucky&&(this.myLucky.blocks=t)},prizes(t){this.myLucky&&(this.myLucky.prizes=t)},buttons(t){this.myLucky&&(this.myLucky.buttons=t)},defaultStyle(t){this.myLucky&&(this.myLucky.defaultStyle=t)},defaultConfig(t){this.myLucky&&(this.myLucky.defaultConfig=t)}},methods:{async imgBindload(t,e,i,n){(async(t,e,i="src",n="$resolve")=>{let a;a=window?new Image:e.createImage(),a.onload=()=>{t[n](a)},a.onerror=t=>{console.error(t)},a.src=t[i]})(this[e][i].imgs[n],this.canvas)},getImage(){return et.call(this,"lucky-wheel",this.canvas)},hideCanvas(){},initLucky(){this.boxWidth=tt(this.width),this.boxHeight=tt(this.height),this.isShow=!0,this.$nextTick((()=>{setTimeout((()=>{this.draw()}))}))},draw(){const e=this;i().in(this).select("#lucky-wheel").fields({node:!0,size:!0}).exec((i=>{if(i[0].node=document.querySelector("#lucky-wheel canvas"),!i[0]||!i[0].node)return console.error("lucky-canvas 获取不到 canvas 标签");const{node:n,width:a,height:r}=i[0],o=this.canvas=n,s=this.ctx=o.getContext("2d"),l=this.dpr=t().pixelRatio,c=Math.min(a,r)/2;this.myLucky=new _t({flag:"WEB",ctx:s,dpr:l,setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval,rAF:requestAnimationFrame,unitFunc:(t,e)=>tt(t+e),beforeCreate:function(){s.translate(c,c)},beforeResize:function(){s.translate(-c,-c)},afterInit:function(){e.btnWidth=2*this.maxBtnRadius,e.btnHeight=2*this.maxBtnRadius,e.$forceUpdate()},afterStart:()=>{this.imgSrc=""}},{...this.$props,width:a,height:r,start:(...t)=>{this.$emit("start",...t)},end:(...t)=>{this.$emit("end",...t),this.hideCanvas()}})}))},toPlay(t){this.myLucky.startCallback()},init(){this.myLucky.init()},play(...t){this.myLucky.play(...t)},stop(...t){this.myLucky.stop(...t)}}},[["render",function(t,e,i,f,p,g){const m=c,y=h,v=u,w=d;return p.isShow?(n(),a(w,{key:0,class:"lucky-box",style:s({width:p.boxWidth+"px",height:p.boxHeight+"px"})},{default:r((()=>[o(m,{type:"2d",id:"lucky-wheel","canvas-id":"lucky-wheel",style:s({width:p.boxWidth+"px",height:p.boxHeight+"px"})},null,8,["style"]),p.imgSrc?(n(),a(y,{key:0,src:p.imgSrc,onLoad:e[0]||(e[0]=t=>p.myLucky.clearCanvas()),style:s({width:p.boxWidth+"px",height:p.boxHeight+"px"})},null,8,["src","style"])):l("v-if",!0),o(v,{class:"lucky-wheel-btn",onClick:g.toPlay,style:s({width:p.btnWidth+"px",height:p.btnHeight+"px"})},null,8,["onClick","style"])])),_:1},8,["style"])):l("v-if",!0)}],["__scopeId","data-v-26363096"]]);var Rt=K({__name:"Luckydraw",setup(t){const e=t,i=Q(["islogin","saveOem","AddressChoose","userinfo","MerchantId"]),{islogin:s,userinfo:c,MerchantId:u,AddressChoose:K,saveOem:J}=i,tt=f(0),et=f(""),it=p({tetsArr:["有道是晴空一鹤排云上,抱得大奖喜滋滋~","哇塞,大奖一出谁与争锋~","哇哦,恭喜中奖,拆开属于你的礼物吧","真棒!这运气~霸气侧漏的一抽"],GetLuckyDrawByIdDate:{},GetLuckyPrizeByLDIdDate:{},ClickLuckyDrawDate:{},AddLuckyRecordDate:{},GetLuckUserCountDate:{},optionData:{},text:[],prizes:[{fonts:[{text:"谢谢参与",top:"10%",fontColor:"#D27A48",fontSize:"32rpx"}],imgs:[{src:"https://appwx.xuezhilian.com/xzb/static/smail.png",top:"34%",width:70,height:72}],background:"#fffce7",range:45,Id:0}],AddLuckyUserDate:{name:"",phone:"",sex:"",address:"",remark:""},AddLuckyUser:{},rules:{name:{rules:[{required:!0,errorMessage:"姓名不能为空"}]},phone:{rules:[{required:!0,errorMessage:"电话不能为空"},{pattern:"(^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$)",errorMessage:"电话错误"}]}},addressList:[],abj:[],guchi:[]}),{tetsArr:nt,AddLuckyUserDate:at,GetLuckyDrawByIdDate:rt,GetLuckyPrizeByLDIdDate:ot,ClickLuckyDrawDate:st,AddLuckyRecordDate:lt,GetLuckUserCountDate:ct,text:ht,optionData:ut,prizes:dt,abj:ft,guchi:pt,addressList:gt,rules:mt}=g(it),yt=f(null),vt=f(null),wt=f(null),bt=f(0),kt=f(null),xt=f(null),Ct=f(!1),At=f(!1),zt=f(!1),St=f(!1),It=f(!1),Lt=f("");f(0),f(0);const Dt=f(null);let _t=f(null);const Rt=f([{radius:"45%",imgs:[{src:"https://appwx.xuezhilian.com/xzb/static/buttons.png",width:"60%",top:"-90%"}],pointer:!0}]),Ft=f([{padding:"8px",imgs:[{src:"https://appwx.xuezhilian.com/xzb/static/Golden.png",width:"100%",height:"100%"}]},{padding:"9px",imgs:[{src:"https://appwx.xuezhilian.com/xzb/static/Golden.png",width:"100%",height:"100%",rotate:!0}]}]);function Et(){kt.value.close(),xt.value.open()}async function Wt(){const t=Y(it.GetLuckyDrawByIdDate.BeginTime),e=Y(it.GetLuckyDrawByIdDate.EndTime);if(!t)return void D({title:"提示",content:`抱歉！活动未开始，请于${it.GetLuckyDrawByIdDate.BeginTime}  8:00后参加`,showCancel:!1});if(e)return void uni.$u.toast("抱歉！活动已结束");if(it.GetLuckUserCountDate.res1<=0)return void uni.$u.toast("抽奖机会已用尽",2e3);_();const i={merchantId:it.optionData.MerchantId,luckyId:it.optionData.Id};T(i).then((t=>{t&&"success"==t.Result?(wt.value.play(),it.GetLuckUserCountDate.res1=it.GetLuckUserCountDate.res1-1):"error1"==t.Result.Code&&(it.GetLuckUserCountDate.res1=it.GetLuckUserCountDate.res1-1,it.prizes.forEach(((t,e)=>{console.log("11error1================",t.fonts[0].text),"谢谢参与"==t.fonts[0].text?it.prizes[e].range=100:it.prizes[e].range=0})),wt.value.play())})).catch((t=>{})),setTimeout((()=>{wt.value.stop()}),3e3)}async function Ot(t){console.log("bask",t);var e=Math.floor(Math.random()*it.tetsArr.length);Lt.value=it.tetsArr[e],console.log("opop",it.tetsArr[e]);const i={merchantId:1*it.optionData.MerchantId,luckyId:1*it.optionData.Id,prizeid:t.Id};R(i).then((e=>{e&&e.Result?(it.AddLuckyRecordDate=e.Result,pt.value=t.fonts[0].text,bt.value=e.Result.LuckUserId,console.log("luckid",bt.value),bt.value?(console.log("pageData.AddLuckyRecordDate",it.AddLuckyRecordDate.AcceptWay),1==it.AddLuckyRecordDate.AcceptWay?St.value=!0:2==it.AddLuckyRecordDate.AcceptWay?kt.value.open():It.value=!0):zt.value=!0):uni.$u.toast("请重试")})).catch((t=>{uni.$u.toast(res.Message||"网络错误 请重试")}))}return j((t=>{console.log("路由信息",t),t&&t.MerchantId?(it.optionData=t,async function(){const t={merchantId:it.optionData.MerchantId,Id:it.optionData.Id};let e=await v(t);e.Result.Remark=`<p>抽奖时间: ${e.Result.BeginTimes} - ${e.Result.EndTimes}</p>${e.Result.Remark}`,it.GetLuckyDrawByIdDate=e.Result,console.log("baga13",e),et.value=it.GetLuckyDrawByIdDate.BgImg,console.log("背景ok",et.value),function(){let t=window.location.href,e=x(it.GetLuckyDrawByIdDate);console.log("自定义分享信息",e),Z({share_title:e.Name,share_desc:e.Organizer,share_link:t,share_cover:"https://appwx.xuezhilian.com/xzb/static/buttons.png"})}(),w({title:e.Result.Name})}(),async function(){const t={merchantId:it.optionData.MerchantId,luckyId:it.optionData.Id},e=["#FFEDD6","#FFFBF3","#FFEDD6","#f4f1ea","#FFFBF3","#FFEDD6","#eeebe3","#f4f1ea"];b(t).then((t=>{const i=[];t.Result.forEach(((t,n)=>{i.push(t.Probability);const a=i.reduce(((t,e)=>t+e));tt.value=100-a,console.log("Probability.value",tt.value);let r={fonts:[{text:t.Prize,top:"10%",fontColor:"#D27A48",fontSize:"32rpx"}],imgs:[{src:t.PrizeImg,top:"42%",width:46,height:58}],Id:t.Id,background:e[n],range:t.LeftCount<=0?0:t.Probability};it.prizes.push(r)}))})).catch((t=>{}))}(),async function(){const t={merchantId:1*it.optionData.MerchantId,luckyId:1*it.optionData.Id};let e=await k(t);it.GetLuckUserCountDate=e.Result,console.log("baga20",e)}()):location.replace("https://appwx.xuezhilian.com/xzb/index.html#/pages/error/404")})),H((()=>{!function(){if(!s.value)return;C({permission:"Shop-Address",queryField:"Id,UserName,Address,Mobile,DefaultChoose,DefaultChooseText",entityName:"CirclesFinancial.Modals.Shop.OrderAddress",whereField:"{}"}).then((t=>{const e=t.Result;e&&"object"==typeof e&&e.length>0&&(it.addressList=e,it.AddLuckyUserDate.phone=e[K.value].Mobile||"",it.AddLuckyUserDate.name=e[K.value].UserName||"",it.AddLuckyUserDate.Address=e[K.value].Address||"")})).catch((t=>{}))}()})),$((()=>{m({success:t=>{let e=t.windowHeight/t.windowWidth;console.log("高度:",e),e<1.8?(console.log("非全面屏",Math.ceil(.7*t.windowWidth)),yt.value=Math.ceil(.7*t.windowWidth)):(console.log("全面屏",e),yt.value=Math.ceil(.9*t.windowWidth))}}),vt.value=document.body.clientHeight})),y((()=>{})),(t,i)=>{const c=h,u=d,f=F,p=U(E("uni-popup"),M),g=W,m=U(E("uni-forms-item"),B),y=U(E("u-radio"),V),v=U(E("u-radio-group"),G),w=U(E("uni-forms"),P),b=U(E("u-parse"),N),k=U(E("u-modal"),X),x=O;return n(),a(u,{class:""},{default:r((()=>[o(u,{class:""},{default:r((()=>[l(' \t\t\t<view :style="`background-image: url(${ImgBg});`" class="imgBOY flex flex-column justify-around align-centerposition-relative" v-if="prizes && prizes.length > 0"> '),A(dt)&&A(dt).length>0?(n(),a(u,{key:0,class:"imgBOY flex flex-column justify-around align-center position-relative"},{default:r((()=>[o(c,{src:et.value,mode:"",class:"position-absolute bjimg",onLoad:i[0]||(i[0]=t=>{et.value})},null,8,["src"]),o(c,{class:"Lucky-Rs",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABlCAMAAABjot39AAABWVBMVEX///8AAAACAgICAgIDAwMAAAABAQEBAQH6+vr5+fmmpqb29vasrKzw8PBPT0+YmJjk5ORWVlZKSkpkZGS4uLgyMjLr6+tUVFQ4ODhTU1NdXV3MzMzY2NhFRUX39/f29vbc3Nzn5+f5+fn6+vrv7+/k5OTa2toiIiI+Pj5ZWVl3d3fAwMD4+Pjz8/Ps7Oy4uLjExMSlpaWbm5vKysq2trYeHh5NTU1ubm6Dg4OMjIyRkZGioqLS0tLd3d3y8vLm5ubi4uLd3d3BwcFubm5zc3OIiIidnZ2wsLC7u7v39/f19fXi4uLu7u7q6urT09PQ0NDJycnT09PFxcXExMTQ0NCurq6Ojo5ISEhxcXGnp6dBQUF9fX23t7fv7+/r6+vc3Nyvr6/X19e9vb2WlpbHx8dpaWnt7e3v7+/a2trY2Ni8vLyPj4/T09N1dXWfn5/m5uZYWFgsLCwvLy+CU2wKAAAAcXRSTlPMAAUPCwgTF8zN383dz/Xi0fP379r9zwn89PHX0/jBuYuCycWpi04V+vLq2cawoFhSSj8zJx/17Ofl5ODV07aebF8wK+vm4dzayLSemZB/dGxlZF1BPDAmIxv56duimH1QRz86Ku6wmnVoXEA5MhCMHYhGmBQAAAU6SURBVGje7dr5U9pAFMDx100CCREFWwRBQVDwqPdRrfdZ79tq7V219/n8/39o1phZx7cCCTudaaffH3rJ8Jn3dsN0RuHen+i/8tcrLJlMjn4rLcwvlL6NOn9m6pXk4vxWX9YyTXAyTcvK9n2cX0yqVH68y2+YQDNn8+9+qFFY6XWvIAjU+7pUu8KOOm4RFOo4YrUpI/3EkDlbIzUoF9sFqK7C9kVAhS2sQ/WtL7AgSjIP/son/SunH8FvW6d+lZEc+G/jwp/yrh2ClC35UNi8CcEy51nVSokjAZlSlQobaYfgtY+wahR2moNa2jhlVSjJV1Bbr5KVFZaHWsuzSgr7DLW3wMorbLRdgdI7ysopjBVBRUXGyimLBSXK+mgZhRnboKZtg92tLJqKFGuEKGKULVDVa4PJFcaOTGWKeXSnkgd15RmTK3pOoZLTpQpjZ6ZCxTxjTKq8AZW9oQpH9D6lSp/OGaLIH5ae9Bq//7YXONlNXlH3RQ/qx+kjMypTDPmn8SOMOL/G0Yu/bwN6NbovimA9kPYNoYiFFcsqlwmeRGltbZIrRb4yovQDKR2PJ7A1Hm+JY93VFjzlvsl7yRXEmFzplynaBpBS6JbhSqQhKhTIjD+GB2WVPo0qhtYLpNW6uufYU1cX5UorttxQ6rC5gpLVDKo8M8ucSxDFenZbYcx4qloxnxqM3VYGgRSLRCJduByJZAIpgxJlH0gP8boJrqQw6kuBA6ron4A0nU6nL7E+nZ5yFBtT4E/5pFNlH2Q1IWbcc2nBRz6VfYkyKD39NcRJV3mJ928qk/i+4rkQxdDPpMpjRGwAGG9cW8bxlmhjo6f04ETFOyZRji2Zksbu55wBM4WX+BCcXKUZn1RQrGPdIMovqZLC1emE84bOOXTFPeVhz5MZxGmITa2WUQqdEqUzK0FeYsKGCPZAJoGT3Y4y0xAD3gust9N8RohEbLmS65ScfmcHkOznOM4Px55JYdzmygNcdneGU0/4xXCTKh0yRSsC6QVeZji2ksDWKHTjFKzgY4BYD2Laggnkf+GtYDOQihpVDO2QvC5ziSv8ty7E+tiVmUJcg4YEYrcN4DCO25JIOV+foMqhZlBFpx/KscZm/m/Rrq7I1UdBM2Jq2VExNWkD7z3HHBnjLQRpf6ZLFNnBRN2jnra9R8C9h6tR79z4F2IzM01A6+8kCr9k2i6obFfjF5kqT5X+3/KcKO4lC+cUKrNhTWdE4cO0KVTa+ChSZdBUt7BBongrC80pU+ZC7sKEIoYZVjVMYViMQpTQT0VKMUQUsTLtuKAE6T3WvIURhQ+j5pq9EaMIRTyY2lJWAZJd0txHkijeMHsKlC/uKEQRwyjY2U7IHYUqYpix/loflbA3ClXEMEuzNSF9Jw6iC4QqLjPcXsvJn1/tiyhkZ6HD4Ij5NkT2RRWmc2bHDIrshui+XIXuLDQQbGm9AyGxL6JQZjjIFZgdFghRpMzSK99I/5JAqCJnxvw+nm1jAqmseEx4r+DDWD8IE4QoUmZ406rSsDbPPaSSQpnw0JxVjTE3FCaTEEXKXDtvq/je69trQyBUkTqCCX/ZtM27CXvzMEyQsgrdmuucDLTlLNmmcm0DJ65BjkSqyBnX4dDY0M4H27Ys07z+/r5tf9gZGuOEa1CEKnLHEA7v5PvXoYGDvd29g4Ghr9+5cMOg26KKnPEcDnHpViFOeAZBiFLZ4RBNI4ZvRTgexBPv7xHC8KFQx4OuKQF4BDcCKNThEKdEhisII5BCIYG570+J4AqVhPD3/gTRf+WfU34DNgD1WM23pyAAAAAASUVORK5CYII=",alt:"",id:"headId",onClick:i[1]||(i[1]=t=>Ct.value=!0)}),o(c,{class:"Lucky-Bs",src:"./assets/Lucky-B.abba6553.png",alt:"",mode:"widthFix"}),o(u,{class:"lucky-bos"},{default:r((()=>[z("img",{class:"Lucky-Ge",src:"./assets/GoodB.5eacabe3.png",alt:""}),z("img",{class:"Lucky-Ts",src:"./assets/Lucky-T.f910f5f2.png",alt:""}),z("img",{class:"Lucky-Gs",src:"./assets/GoodB.5eacabe3.png",alt:""})])),_:1}),A(s)?(n(),a(u,{key:0,class:"lucky-cy"},{default:r((()=>[S("参与人次："+I(A(ct).res2),1)])),_:1})):l("v-if",!0),yt.value?(n(),a(u,{key:1,class:"LuckyBoy flex justify-center align-center"},{default:r((()=>[o(Tt,{ref_key:"myLucky",ref:wt,width:yt.value+"px",height:yt.value+"px",blocks:Ft.value,prizes:A(dt),buttons:Rt.value,onStart:Wt,onEnd:Ot},null,8,["width","height","blocks","prizes","buttons"])])),_:1})):l("v-if",!0),A(s)?(n(),a(u,{key:2,class:"color-ziti",ref_key:"menu_item",ref:_t},{default:r((()=>[o(u,null,{default:r((()=>[S("剩余次数 "+I(A(ct).res1<0?0:A(ct).res1)+" 次",1)])),_:1}),o(u,{onClick:i[2]||(i[2]=t=>A(q)(`/pages/Myluckys/index?MerchantId=${e.MerchantId}`))},{default:r((()=>[S(" 我的奖品 ")])),_:1})])),_:1},512)):l("v-if",!0)])),_:1})):l("v-if",!0)])),_:1}),o(u,null,{default:r((()=>[o(p,{ref_key:"popup",ref:kt,type:"center"},{default:r((()=>[o(u,{class:"pop-ke"},{default:r((()=>[o(u,{class:"pop-luvk"},{default:r((()=>[o(u,{style:{"margin-top":"40rpx","font-size":"26rpx",color:"#eab378"}},{default:r((()=>[S(I(Lt.value),1)])),_:1})])),_:1}),o(u,{class:"pop-luvk"},{default:r((()=>[o(u,{style:{"margin-top":"60rpx",color:"#636363"}},{default:r((()=>[S(I(A(pt)),1)])),_:1})])),_:1}),o(u,{class:"pop-luvk"},{default:r((()=>[z("img",{style:{"margin-top":"60rpx",color:"#636363"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAYFBMVEUAAAD9iyf8iyf+iyb+iyf9iyf+iyb8iyj+iyb+iyb9iyb9iyf+iyb9iyf9iyf+iyb9iyf+iyb+iyf+iyf+iyb+iyf+iyf+iyb+iyf9iyf9iyb+iyb+iyf9iyf9iyf+iycjuYnFAAAAH3RSTlMA6gfL1FgTRrpNQzyB4XvaDSXyX6FlHZdywW0wr4yolq2wpgAAAkpJREFUWMPtlteyozAMht0oxmDTITS//1uuLW8IxZM5sLPniu8ik4mkX4okbNAKGZtFYUO2DGOOTpAwkXFmHVRdhejMWLNSAyWb+uIUL+aX0g7MutYTrzdknSA7c9tMpd4gjwq5hNyKMeUc46rdyqfK5TYOmTaoiqAdIra/dk0kqjo7FkHEpAGW8iRqwGEa0Y4GmxDZ5gTlLe8wlBMHyBFQCFezCIlxKFJTpGrQjt440AQ5iv4FEbSBaQwQj7vg3dkoM9n6QwVGlPK15VENRbCIIMLha5Z+BsPxuQKuTI7+05hihk4sYy4Y5N+0PUw1ZNtR1IfGhD30fa6gf2oIN8nsH6xXwU1ZuNu4keAFc4OZcnLIlVW7JeK97EpolFzpZ6rf0LSXKwu2nrUc+Ohkw2Bh+g60hmUjfanvgtMcEWjJXSh3LdEq9vIqTZbYj3s2F8QpPDki8SBgO2SU+IgGK5+hQZlPgfzk1P7P0G8kgZVH0u51cUcACWtF6TeB8BH4FYF/H2Nvt6HKEfHgKpChz2jKs7lLt8p0EJEHt8ozTzy2JBkybStoOzgymRf1xQYXTDkhFCh9n1eAUCtvKsDVE9pZuYMX+/hq0It4X312lHMVHOGNbWIHhj0Ds81Zz2qRwSV05u8Yz4ZcWmmxngymIiouLRJMn+8FLq1y8Ag8Ao/AI/AI/GeB+8c6NwIsIein7weI5INyAg642iRPfvp+kCSNLUCtRbexNgrqwvtBZg1T8RYgFdbXwUH+aVbK9FVomm/n1VB8jVfl4v8A0K2Sqyi553oAAAAASUVORK5CYII=",alt:""})])),_:1}),o(u,{class:"pop-luvk mt-5",onClick:Et},{default:r((()=>[o(f,{type:"primary",size:"mini",style:{"border-radius":"30rpx",width:"150rpx"}},{default:r((()=>[S("领 取")])),_:1})])),_:1})])),_:1}),l(' \r\n\t\t\t\t<view style="width: 100%;height: 100rpx;display: flex;justify-content: center;" @click="close">\r\n\t\t\t\t\t<view style="font-size: 120rpx;">×</view>\r\n\t\t\t\t</view> ')])),_:1},512)])),_:1}),o(u,null,{default:r((()=>[o(p,{ref_key:"popups",ref:xt,type:"center"},{default:r((()=>[o(u,{class:"pop-ke"},{default:r((()=>[o(u,{style:{width:"100%",height:"70rpx",display:"flex","justify-content":"center","align-items":"center"}},{default:r((()=>[S(" 填写信息")])),_:1}),o(u,{class:"example"},{default:r((()=>[o(w,{ref_key:"baseForm",ref:Dt,rules:A(mt),model:A(at)},{default:r((()=>[o(m,{label:"姓名",required:"",name:"name"},{default:r((()=>[o(g,{class:"addsub",type:"text",placeholder:"请填写姓名",modelValue:A(at).name,"onUpdate:modelValue":i[3]||(i[3]=t=>A(at).name=t)},null,8,["modelValue"])])),_:1}),o(m,{class:"addsubs",label:"电话",required:"",name:"phone"},{default:r((()=>[o(g,{class:"addsub",type:"number",maxlength:"11",value:"",placeholder:"请填写电话",modelValue:A(at).phone,"onUpdate:modelValue":i[4]||(i[4]=t=>A(at).phone=t)},null,8,["modelValue"])])),_:1}),o(m,{class:"addsubs",label:"性别",name:"sex"},{default:r((()=>[o(v,{modelValue:A(at).sex,"onUpdate:modelValue":i[5]||(i[5]=t=>A(at).sex=t)},{default:r((()=>[o(y,{name:1},{default:r((()=>[S("男")])),_:1}),o(y,{name:2,"active-color":"#F6ABC0"},{default:r((()=>[S("女")])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(m,{class:"addsubs",label:"联系地址"},{default:r((()=>[o(g,{class:"addsub",type:"text",value:"",placeholder:"请填写详细地址",modelValue:A(at).Address,"onUpdate:modelValue":i[6]||(i[6]=t=>A(at).Address=t),onClick:i[7]||(i[7]=t=>A(q)("../address/index"))},null,8,["modelValue"])])),_:1}),o(m,{class:"addsubs",label:"备注",name:"remark"},{default:r((()=>[o(g,{class:"addsub",type:"textarea",value:"",placeholder:"填写备注",modelValue:A(at).remark,"onUpdate:modelValue":i[8]||(i[8]=t=>A(at).remark=t)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"]),o(f,{type:"primary",onClick:i[9]||(i[9]=t=>async function(){At.value=!0,Dt.value.validate().then((t=>{const i={merchantId:e.MerchantId,luckyUserId:bt.value,address:it.addressList[K.value].Id,...t};console.log("success",i),L(i).then((t=>{t&&"success"==t.Result&&xt.value.close()})).catch((t=>{}))})).catch((t=>{console.log("err",t)}))}())},{default:r((()=>[S("提 交")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1}),o(u,null,{default:r((()=>[o(k,{modelValue:Ct.value,"onUpdate:modelValue":i[10]||(i[10]=t=>Ct.value=t),"title-style":{color:"#fd8b27"},title:"活动规则"},{default:r((()=>[o(u,{class:"slot-content"},{default:r((()=>[l(' <view style="font-size: 24rpx;">抽奖时间: {{GetLuckyDrawByIdDate.BeginTimes}}-{{GetLuckyDrawByIdDate.EndTimes}}</view> '),o(b,{html:A(rt).Remark,"lazy-load":!0},null,8,["html"])])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(u,null,{default:r((()=>[o(k,{modelValue:At.value,"onUpdate:modelValue":i[11]||(i[11]=t=>At.value=t),"title-style":{color:"#fd8b27"},title:"消息"},{default:r((()=>[o(u,{class:"slot-content"},{default:r((()=>[o(u,{class:"adbTy","lazy-load":!0},{default:r((()=>[S("提交成功")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(u,null,{default:r((()=>[o(k,{modelValue:zt.value,"onUpdate:modelValue":i[12]||(i[12]=t=>zt.value=t),"title-style":{color:"#fd8b27"},title:"消息"},{default:r((()=>[o(u,{class:"slot-content"},{default:r((()=>[o(u,{class:"adbTy","lazy-load":!0},{default:r((()=>[S("很遗憾😞没有中奖,再接再厉")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(u,null,{default:r((()=>[o(k,{modelValue:St.value,"onUpdate:modelValue":i[13]||(i[13]=t=>St.value=t),"title-style":{color:"#fd8b27"},title:"消息"},{default:r((()=>[o(u,{class:"slot-content"},{default:r((()=>[o(u,{class:"adbTy","lazy-load":!0},{default:r((()=>[S("恭喜中奖啦,获得'"),o(x,{style:{color:"#ffaa00"}},{default:r((()=>[S(I(A(pt)),1)])),_:1}),S("',此为现场领取奖品,去我的奖品查看奖品后,联系现场老师领奖吧")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(u,null,{default:r((()=>[o(k,{modelValue:It.value,"onUpdate:modelValue":i[14]||(i[14]=t=>It.value=t),"title-style":{color:"#fd8b27"},title:"消息"},{default:r((()=>[o(u,{class:"slot-content"},{default:r((()=>[o(u,{class:"adbTy","lazy-load":!0},{default:r((()=>[S("恭喜中奖啦,获得'"),o(x,{style:{color:"#ffaa00"}},{default:r((()=>[S(I(A(pt)),1)])),_:1}),S("',此为虚拟奖品,去我的奖品查看兑换码后领奖吧")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}}},[["__scopeId","data-v-0df78bd9"]]);export{Rt as default};
