import{e,r as a,t as l,a as t,o as s,a8 as n,a0 as o,f as i,g as r,w as c,i as d,u,l as f,k as m,j as p,p as g,q as x,F as h,m as y,aY as v,ad as _,aZ as k,af as b,s as I,aw as j,a_ as C,a$ as w,y as R,C as S,x as z,aa as D,D as F,aq as O,ay as P,b0 as A,S as M,n as B,a4 as N,E as $}from"./index.1a866322.js";import{_ as L}from"./u-icon.1541541b.js";import{o as T,a as V,d as U,r as E}from"./uni-app.es.5638d019.js";import{_ as q,a as W}from"./u-radio-group.12866b1c.js";import{h as Y}from"./methods.10d71805.js";import{u as H}from"./useState.33e874ff.js";import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";import"./emitter.5b880544.js";import"./index.0e6263ad.js";const X=[{key:1,value:"母亲",img:"../../../static/Relation/woman.png"},{key:2,value:"父亲",img:"../../../static/Relation/man.png"},{key:3,value:"爷爷",img:"../../../static/Relation/oldMan.png"},{key:4,value:"奶奶",img:"../../../static/Relation/oldWoman.png"},{key:5,value:"外公",img:"../../../static/Relation/oldMan.png"},{key:6,value:"外婆",img:"../../../static/Relation/oldWoman.png"},{key:7,value:"其他",img:"../../../static/Relation/other.png"}];var Z=J({__name:"index",setup(J){const Z=J,G={AvatarImg:"",StudentName:"",IDCard:"",Sex:"",BirthDay:"",Relation:"",RelationText:""},K=e((()=>function(e){return e&&e.length>5?e.substring(0,5)+"...":e||""}));H(["MerchantId","islogin"]);const Q=a({tmenuList:[],editObj:{...G},sexList:[{key:"1",value:"男"},{key:"2",value:"女"}],RelationListData:X}),{tmenuList:ee,editObj:ae,sexList:le,RelationListData:te}=l(Q);t(20),t(1),t(1),t(!0);const se=t(0);let ne;function oe(){let e={merchantId:Z.MerchantId};n(e).then((a=>{const l=a.Result;Array.isArray(l)&&(Q.tmenuList=l),e.Message&&o({title:e.Message,icon:"none"})})).catch((e=>{}))}function ie(e){let a=N.host.api;e&&v({count:1,sizeType:["original"],sourceType:[e],success:e=>{e.tempFilePaths&&e.tempFilePaths[0]&&(_({title:"图片上传中..."}),k({url:`${a}Home/UploadImage`,filePath:e.tempFilePaths[0],name:"avatar",success:e=>{if(200==e.statusCode&&e.data&&(e.data.indexOf("http://")>-1||e.data.indexOf("https://")>-1)){const a=JSON.parse(e.data);Q.editObj={...Q.editObj,AvatarImg:a.Result},b()}else console.error("提交失败：",e),o({title:(bool?"修改":"添加")+"失败，稍后再试！",icon:"none"}),b()},fail:e=>{b(),console.error("提交失败：",e),o({title:(bool?"修改":"添加")+"失败，稍后再试！",icon:"none"})}}))}})}function re(e){I({title:(e.Id?"编辑":"添加")+"学员"}),Q.editObj=e.Id?{...G,...e,Relation:e.RelationFlag}:{...G},se.value=1}function ce(e){if(1==e)Q.editObj={...G},ne?j({delta:1}):se.value=0;else{_({title:"加载中...",mask:!0});!function(e){let a={merchantId:Z.MerchantId},l=!1;for(let t in Q.editObj)"IDCard"==t||Q.editObj[t]?a[t]=Q.editObj[t]:l=!0;if(l)return void o({title:"请填写完整",icon:"none"});e?C(a).then((a=>{a.Result&&(o({title:(e?"修改":"添加")+"成功"}),ne?j({delta:1}):(console.log("学员信息===>",Q.editObj),se.value=0,oe()))})).catch((e=>{})):w(a).then((a=>{a.Result&&(o({title:(e?"修改":"添加")+"成功"}),ne?j({delta:1}):(se.value=0,oe()))})).catch((e=>{}))}(!!Q.editObj.Id)}}function de(e,a,l){e&&a.Id&&$({url:`../../${e}/index?StudentId=${a.Id}&AvatarImg=${a.AvatarImg||""}&StudentName=${a.StudentName||""}&Sex=${a.Sex||""}&MerchantId=${Z.MerchantId}`})}function ue(e){console.log("生日==>",e.detail.value),Q.editObj.BirthDay=e.detail.value}return s((()=>{})),Y(),T((e=>{console.log("页面初始化"),e.MerchantId?(e.fromUrl&&(ne=e.fromUrl,se.value=1),oe()):location.replace("https://appwx.xuezhilian.com/xzb/index.html#/pages/error/404")})),V((()=>{console.log("页面出现时")})),U((()=>{if(!ne&&1==se.value)return se.value=0,!0})),(e,a)=>{const l=R,t=d,s=S,n=E(z("u-icon"),L),o=D,v=F,_=O,k=P,b=E(z("u-radio"),q),I=E(z("u-radio-group"),W),j=A,C=M;return i(),r(t,{class:""},{default:c((()=>[u(ee).length<=0&&0==se.value?(i(),r(t,{key:0,class:"text-light-A font-small text-center mt-5"},{default:c((()=>[f("账号下还未有学员，点击"),m(l,{class:"color-main",onClick:a[0]||(a[0]=e=>re({}))},{default:c((()=>[f("添加")])),_:1})])),_:1})):p("v-if",!0),m(C,{"indicator-dots":!1,autoplay:!1,circular:"",class:"swiper",current:se.value,"disable-touch":!0},{default:c((()=>[m(v,null,{default:c((()=>[m(o,{"scroll-y":"",style:"width: 100%;height:100vh;"},{default:c((()=>[m(t,{class:"page w-100"},{default:c((()=>[(i(!0),g(h,null,x(u(ee),((e,a)=>(i(),r(t,{key:e.Id,class:"flex flex-column cellDiv"},{default:c((()=>[m(t,{class:"flex align-center cellTop justify-between align-center"},{default:c((()=>[m(t,{class:"flex align-center"},{default:c((()=>[m(s,{src:e.AvatarImg,mode:"",class:"headImg"},null,8,["src"]),m(t,{class:"wrap"},{default:c((()=>[m(t,{class:"flex align-center"},{default:c((()=>[m(l,{class:"nameP pColor",style:{"padding-right":"10rpx"}},{default:c((()=>[f("姓名："+y(u(K)(e.StudentName)),1)])),_:2},1024),m(n,{name:1==e.Sex?"man":"woman",color:1==e.Sex?"#409EFF":"#FD577B",size:"28"},null,8,["name","color"])])),_:2},1024),m(l,{class:"nameP",style:{"font-size":"26rpx"}},{default:c((()=>[f("生日："+y(e.BirthDay||""),1)])),_:2},1024),m(l,{class:"nameP",style:{"font-size":"26rpx"}},{default:c((()=>[f("关系："+y(e.RelationText||""),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),m(n,{name:"edit-pen-fill",color:"#2979ff",size:"40",onClick:a=>function(e,a){re(e)}(e)},null,8,["onClick"])])),_:2},1024),m(t,{class:"wrap",style:{padding:"20rpx","padding-bottom":"10rpx"}},{default:c((()=>[m(t,{onClick:a=>de("studentClass",e),class:"classDiv","hover-start-time":0,"hover-stay-time":0,"hover-class":"hover"},{default:c((()=>[m(t,{class:"flex wrap studengClass align-center",onClick:a=>de("studentClass",e)},{default:c((()=>[m(n,{name:"list",color:"#F68316",size:"35"}),m(t,{class:"ml-1"},{default:c((()=>[f("学员课程")])),_:1})])),_:2},1032,["onClick"]),m(n,{name:"arrow-right",color:"#aaa",size:"30"})])),_:2},1032,["onClick"]),m(t,{onClick:a=>de("classes",e),class:"classDiv","hover-start-time":0,"hover-stay-time":0,"hover-class":"hover"},{default:c((()=>[m(t,{class:"flex wrap studengClass align-center",onClick:a=>de("classes",e)},{default:c((()=>[m(n,{name:"grid-fill",color:"#F68316",size:"35"}),m(t,{class:"ml-1"},{default:c((()=>[f("学员班级")])),_:1})])),_:2},1032,["onClick"]),m(n,{name:"arrow-right",color:"#aaa",size:"30"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),m(v,null,{default:c((()=>[m(t,null,{default:c((()=>[m(o,{"scroll-y":"",class:"scroll-wrap",style:{"align-items":"center","background-color":"#fff"}},{default:c((()=>[m(t,{class:"addDiv"},{default:c((()=>[m(l,{class:"nameP",style:{"font-size":"30rpx","font-weight":"bold"}},{default:c((()=>[f("头像")])),_:1}),m(t,{class:"w-100 flex align-center justify-around pb-3",style:{"flex-direction":"row"}},{default:c((()=>[m(t,{class:"centerDiv"},{default:c((()=>[u(ae).AvatarImg?(i(),r(s,{key:0,src:u(ae).AvatarImg,mode:"",class:"addImg"},null,8,["src"])):(i(),g(h,{key:1},[p(' <shm-icons v-else class="addImg imgBor" color="#999" size="100" type="iconxuexiao"></shm-icons> '),m(n,{name:"info-circle",color:"#999",size:"140"})],2112))])),_:1}),m(t,{class:"flex flex-column justify-between align-center bth-con"},{default:c((()=>[m(_,{onClick:a[1]||(a[1]=e=>ie("album")),class:"addImgP"},{default:c((()=>[f("照 片")])),_:1}),m(_,{onClick:a[2]||(a[2]=e=>ie("camera")),class:"addImgP mt-2"},{default:c((()=>[f("拍 照")])),_:1})])),_:1})])),_:1})])),_:1}),m(t,{class:"flex align-center",style:{"margin-top":"10rpx"}},{default:c((()=>[m(l,{class:"nameP pr-2",style:{"font-size":"30rpx","font-weight":"bold"}},{default:c((()=>[f("姓名")])),_:1}),m(k,{class:"flex-1 plr-1 box-border",modelValue:u(ae).StudentName,"onUpdate:modelValue":a[3]||(a[3]=e=>u(ae).StudentName=e),placeholder:u(ae).StudentName||"请输入学员姓名"},null,8,["modelValue","placeholder"])])),_:1}),p(' <view class="flex align-center" style="margin-top: 10rpx;">\n                        <text class="nameP" style="font-size: 30rpx;font-weight: bold;">身份证</text>\n                        <input class="flex-1 plr-1 box-border " v-model="editObj.IDCard" maxlength="18"\n                            :placeholder="editObj.IDCard || \'请输入学员身份证（选填）\'" />\n                    </view> '),m(t,{class:"flex align-center",style:{"margin-top":"10rpx"}},{default:c((()=>[m(l,{class:"nameP pr-2",style:{"font-size":"30rpx","font-weight":"bold"}},{default:c((()=>[f("性别")])),_:1}),m(I,{modelValue:u(ae).Sex,"onUpdate:modelValue":a[4]||(a[4]=e=>u(ae).Sex=e)},{default:c((()=>[(i(!0),g(h,null,x(u(le),((e,a)=>(i(),r(b,{key:a,name:e.key},{default:c((()=>[f(y(e.value),1)])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(t,{class:"flex align-center",style:{"margin-top":"30rpx"}},{default:c((()=>[m(l,{class:"nameP mr-2",style:{"font-size":"30rpx","font-weight":"bold"}},{default:c((()=>[f("学员生日")])),_:1}),m(j,{mode:"date",onChange:ue},{default:c((()=>[m(t,{class:"nameP"},{default:c((()=>[f(y(u(ae).BirthDay||"请选择学员生日日期"),1)])),_:1})])),_:1})])),_:1}),m(t,{class:"addDiv",style:{"margin-top":"30rpx"}},{default:c((()=>[m(l,{class:"nameP",style:{"font-size":"30rpx","font-weight":"bold"}},{default:c((()=>[f("学员与你的关系")])),_:1}),m(t,{class:"RelationDiv flex"},{default:c((()=>[(i(!0),g(h,null,x(u(X),((e,a)=>(i(),r(t,{onClick:a=>function(e,a){Q.editObj={...Q.editObj,Relation:e.key,RelationFlag:e.key,RelationText:e.value}}(e),key:a,class:"RelationP",style:B({background:u(ae).Relation==e.key?"#F68316":"#f5f5f5",color:u(ae).Relation==e.key?"#fff":"#999"})},{default:c((()=>[f(y(e.value),1)])),_:2},1032,["onClick","style"])))),128))])),_:1})])),_:1}),m(t,{class:"menu-btn addSureDiv"},{default:c((()=>[m(_,{class:"addSureP clickBefore",onClick:a[5]||(a[5]=e=>ce(1))},{default:c((()=>[f("取消")])),_:1}),m(_,{class:"addSureP clickBefore",style:{background:"#409EFF",color:"#fff"},onClick:a[6]||(a[6]=e=>ce(2))},{default:c((()=>[f("确定")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["current"]),0==se.value?(i(),r(t,{key:1,class:"position-relative flex justify-center align-center addXY",onClick:a[7]||(a[7]=e=>re({}))},{default:c((()=>[m(n,{name:"man-add-fill",color:"#FFFFFF",size:"46"})])),_:1})):p("v-if",!0)])),_:1})}}},[["__scopeId","data-v-34d90596"]]);export{Z as default};
