import{e,r as a,t as s,a as t,o as l,b1 as i,b2 as c,s as n,X as d,f as r,g as o,w as u,i as f,j as p,k as x,l as g,m as y,u as m,p as C,q as h,F as v,aL as b,b3 as _,V as D,y as S,aq as j,E as I,C as M}from"./index.1a866322.js";import{o as O,a as T}from"./uni-app.es.5638d019.js";import{h as k,e as P}from"./methods.10d71805.js";import{u as w}from"./useState.33e874ff.js";import{_ as N}from"./plugin-vue_export-helper.21dcd24c.js";import"./index.0e6263ad.js";var B=N({__name:"index",setup(N){const B=N;console.log("路由===>",B),k(),e((()=>{})),w(["MerchantId","islogin"]);const R=a({VoucherCodes:[],PictureOne:"",objDetail:{},wxpayObj:{},VoucherObj:{}}),{VoucherCodes:V,PictureOne:E,objDetail:J,wxpayObj:W,VoucherObj:z}=s(R),L=t(""),$=t(!1);function A(){console.log("点击支付===>"),b();let e={sourceId:R.objDetail.Id,Money:R.objDetail.PayMoney,Provider:23,payType:3};_(e).then((e=>{"error"==e.Result.code&&D({title:"提示",content:e.Result.Message,confirmText:"确定",confirmColor:"#fd8b27",showCancel:!1,success:function(e){e.confirm?(console.log("用户点击确定"),d({url:`../order/index?&MerchantId=${B.MerchantId}`})):e.cancel&&console.log("用户点击取消")}}),R.wxpayObj=JSON.parse(e.Result),"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",F,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",F),document.attachEvent("onWeixinJSBridgeReady",F)):F()})).catch((e=>{}))}function F(){let e={appId:R.wxpayObj.AppId,timeStamp:R.wxpayObj.Timestamp,nonceStr:R.wxpayObj.NonceStr,package:R.wxpayObj.PrepayIdPackage,signType:"RSA",paySign:R.wxpayObj.Signature};console.log("onBridgeReady()======>",e),WeixinJSBridge.invoke("getBrandWCPayRequest",e,(e=>{if("get_brand_wcpay_request:ok"==e.err_msg)return R.objDetail&&R.objDetail.MainCategoryId&&309==R.objDetail.MainCategoryId?d({url:`/pages/Bingogame/activeall?Id=${B.activeId}&MerchantId=${B.MerchantId}`}):d({url:`../paySuccess/index?Id=${R.objDetail.Id}&MerchantId=${B.MerchantId}`}),!1}))}return l((()=>{})),i(z,(async(e,a)=>{let s=R.objDetail.TotalPrice||0,t=e.Id?e.VoucherValue:0;const l=Math.round(100*(s-t))/100;if(R.objDetail.PayMoney=l<=0?0:l,l<=0)R.objDetail.integer=0,R.objDetail.decimal="00";else{let e=JSON.stringify(l),a=e.indexOf(".");a>-1?(R.objDetail.integer=e.substring(0,a),R.objDetail.decimal=e.substring(a+1,e.length)):R.objDetail.integer=e}})),O((e=>{"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",F,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",F),document.attachEvent("onWeixinJSBridgeReady",F)):WeixinJSBridge.call("hideOptionMenu"),console.log("路由参数===>",e),e&&e.MerchantId?e.Id&&function(e){let a={OrderId:e,merchantId:B.MerchantId};c(a).then((e=>{if(e.Message)$.value=!0;else{let a=e.Result;if(console.error(1221,a),a&&"object"==typeof a){L.value=a.MainCategoryId;let e=JSON.stringify(a.PayMoney);a.PayMoney=a.PayMoney;let s=e.indexOf(".");s>-1?(a.integer=e.substring(0,s),a.decimal=e.substring(s+1,e.length)):a.integer=e,R.VoucherCodes=[],a.OrderProducts.forEach((e=>{e.VoucherCodes&&e.VoucherCodes.forEach((e=>{R.VoucherCodes.push(e)})),R.PictureOne=e.Picture.split(",")[0];let a=JSON.stringify(e.Price),s=a.indexOf(".");s>-1?(e.integer=a.substring(0,s),e.decimal=a.substring(s+1,a.length)):e.integer=a})),R.objDetail=a,n({title:a.Subject})}}})).catch((e=>{}))}(e.Id):location.replace("https://appwx.xuezhilian.com/xzb/index.html#/pages/error/404")})),T((()=>{console.log("页面出现时")})),(e,a)=>{const s=f,t=S,l=M,i=j;return r(),o(s,{class:"page"},{default:u((()=>[2==L.value?(r(),o(s,{key:0,onClick:e.addAddressClick,class:"addressClass centerDiv"},{default:u((()=>[p(" <shm-icons size=\"45\" :color=\"addressData.Address ? '#666' : '#8679FC'\"\n                :type=\"addressData.Address ? 'icondizhi' : 'icontianjiadizhi'\"></shm-icons> "),p(' <view v-if="addressData.Address" class="addressTextClass">\n                <view style="flex-direction: row;padding-bottom:20rpx;">\n                    <text class="addressName">{{ addressData.UserName }}</text>\n                    <text class="addressName" style="color:#999;">{{ addressData.Mobile }}</text>\n                </view>\n                <text class="addressText">{{ addressData.Address }}</text>\n            </view>\n            <text v-else class="addressText" style="color:#8679FC;flex:1;padding-left:50rpx;">新增地址</text>\n            <shm-icons size="35" color="#999" type="iconnext-copy"></shm-icons> ')])),_:1},8,["onClick"])):p("v-if",!0),x(s,{class:"cellClass"},{default:u((()=>[2==L.value?(r(),o(s,{key:0,class:"heardClass"},{default:u((()=>[p(' <shm-icons color="#777" size="40" type="iconshangdian"></shm-icons> '),x(t,{class:"htClass textOverflowClass"},{default:u((()=>[g(y(m(J).MerchantName),1)])),_:1})])),_:1})):p("v-if",!0),(r(!0),C(v,null,h(m(J).OrderProducts,((e,a)=>(r(),o(s,{class:"contentClass",key:a,onClick:a=>function(e){console.log("item",e),I({url:`/pages/course/courseDetail?Id=${e.ProductId}&MerchantId=${B.MerchantId}`})}(e)},{default:u((()=>[x(l,{src:m(E),mode:"aspectFill",class:"contentImgClass"},null,8,["src"]),x(s,{class:"contentRightClass"},{default:u((()=>[x(s,{class:"KCClass"},{default:u((()=>[x(s,{class:"titleClass"},{default:u((()=>[g(y(m(J).Subject),1)])),_:1}),x(s,{class:"font-smallest mt-1"},{default:u((()=>[g(y(e.Specs),1)])),_:2},1024)])),_:2},1024),p(' <view class="BCClass">\n                        <text class="SPClass"><text v-if="MainCategoryId == 2">x{{ item.ShopNumber }}</text>\n                            &emsp;&emsp;金额：￥</text>\n                        <text class="SPCenterClass">{{ item.integer || \'0\' }}.</text>\n                        <text class="SPCZlass">{{ item.decimal || \'00\' }}</text>\n                    </view> ')])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),x(s,{class:"cell2Class",style:{"margin-top":"15rpx"}},{default:u((()=>[x(s,{class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("学员")])),_:1}),x(t,{class:"priceClass"},{default:u((()=>[g(y(m(J).StudentName),1)])),_:1})])),_:1}),x(s,{class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("金额")])),_:1}),x(t,{class:"priceClass"},{default:u((()=>[g("￥"+y(m(J).integer||0)+"."+y(m(J).decimal||"00"),1)])),_:1})])),_:1}),m(J).PayTime?(r(),o(s,{key:0,class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("支付时间")])),_:1}),x(t,{class:"priceClass"},{default:u((()=>[g(y(m(J).PayTime.replace("T"," ")),1)])),_:1})])),_:1})):p("v-if",!0),2==L.value?(r(),o(s,{key:1,class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("优惠金额")])),_:1}),x(t,{class:"priceClass",style:{color:"#EC6C00"}},{default:u((()=>[g("￥"+y(m(z).VoucherValue||m(J).VoucherValue||0),1)])),_:1})])),_:1})):p("v-if",!0),x(s,{class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("创建时间")])),_:1}),x(t,{class:"priceClass"},{default:u((()=>[g(y(m(J).CreateTime||"xxxxxx"),1)])),_:1})])),_:1}),m(J).OrderNo?(r(),o(s,{key:2,class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText",style:{flex:"1","text-align":"left"}},{default:u((()=>[g("订单编号")])),_:1}),x(t,{selectable:!0,onLongpress:a[0]||(a[0]=e=>m(P)(m(J).OrderNo)),class:"priceClass"},{default:u((()=>[g(y(m(J).OrderNo||""),1)])),_:1})])),_:1})):p("v-if",!0),2==L.value?(r(),o(s,{key:3,class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("运费")])),_:1}),x(t,{class:"priceClass"},{default:u((()=>[g("免运费")])),_:1})])),_:1})):p("v-if",!0)])),_:1}),2==m(J).Status&&null!=m(J).OrderNumber?(r(),o(s,{key:1,class:"cell2Class",style:{"margin-top":"25rpx"}},{default:u((()=>[x(s,{class:"cellDivClass centerDiv"},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("快递")])),_:1}),x(t,{class:"priceClass"},{default:u((()=>[g(y(m(J).LogisticsName),1)])),_:1})])),_:1}),x(s,{class:"cellDivClass centerDiv",onClick:a[1]||(a[1]=a=>e.kuaidiClick(m(J).OrderNumber))},{default:u((()=>[x(t,{class:"cellTitleText"},{default:u((()=>[g("快递单号")])),_:1}),x(t,{style:{flex:"1","text-align":"right",color:"#0087FD","font-size":"35rpx"}},{default:u((()=>[g(y(m(J).OrderNumber.split("_")[1]),1)])),_:1})])),_:1})])),_:1})):p("v-if",!0),x(s,{class:"fixClass"},{default:u((()=>[x(s,{class:"fixLeft"},{default:u((()=>[x(t,{class:"payText"},{default:u((()=>[g("实付款：")])),_:1}),x(t,{class:"payMoney",style:{"font-size":"24rpx"}},{default:u((()=>[g("￥")])),_:1}),x(t,{class:"payMoney"},{default:u((()=>[g(y(m(J).integer||0)+".",1)])),_:1}),x(t,{class:"payMoney"},{default:u((()=>[g(y(m(J).decimal||"00"),1)])),_:1})])),_:1}),x(i,{class:"fixRight clickBefore",onClick:a[2]||(a[2]=a=>e.$u.debounce(A,500)),disabled:0!=m(J).Status},{default:u((()=>[g(y(-1==m(J).Status?"已撤销":0==m(J).Status?"点击付款":1==m(J).Status?"待发货":2==m(J).Status?2==L.value?"确认收货":"已付款":3==m(J).Status?2==L.value?"已确认收货":"已核销":4==m(J).Status?"退款中":5==m(J).Status?"已退款":"充值失败"),1)])),_:1},8,["disabled"]),p(" {{objDetail.Status == -1 ? '已撤销' : objDetail.Status == 0 ? '点击付款' : objDetail.Status == 1 ? '待发货' : objDetail.Status == 2 ? (MainCategoryId==2?'确认收货':'已付款') : objDetail.Status == 3 ? (MainCategoryId==2?'已确认收货':'已核销') :objDetail.Status == 4 ? '退款中' :objDetail.Status == 5 ? '已退款':'充值失败'}} ")])),_:1})])),_:1})}}},[["__scopeId","data-v-0dbf3c5a"]]);export{B as default};
