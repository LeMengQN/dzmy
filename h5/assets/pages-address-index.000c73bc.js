import{r as e,t as a,a as s,o as l,an as t,f as o,g as r,w as n,i as d,k as i,l as c,j as u,u as m,p,q as f,F as h,n as _,m as g,h as C,bB as v,y as A,x as y,ay as k,ax as x,aq as b,ar as S,$ as D,aw as V}from"./index.1a866322.js";import{_ as j}from"./u-icon.1541541b.js";import{o as F,a as w,c as U,b as M,r as N}from"./uni-app.es.5638d019.js";import{_ as I}from"./u-popup.ac74065a.js";import{_ as $}from"./u-picker.31dbc36c.js";import{h as L}from"./methods.10d71805.js";import{u as O}from"./useState.33e874ff.js";import{_ as q}from"./plugin-vue_export-helper.21dcd24c.js";import"./index.0e6263ad.js";function T(e){if(e){if(0===(e+="").length)return e;e=escape(e);for(var a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=[],t=s[64],o=e.length-e.length%3,r=0;r<o;r+=3)a=e.charCodeAt(r)<<16|e.charCodeAt(r+1)<<8|e.charCodeAt(r+2),l.push(s.charAt(a>>18)),l.push(s.charAt(a>>12&63)),l.push(s.charAt(a>>6&63)),l.push(s.charAt(63&a));switch(e.length-o){case 1:a=e.charCodeAt(r)<<16,l.push(s.charAt(a>>18)+s.charAt(a>>12&63)+t+t);break;case 2:a=e.charCodeAt(r)<<16|e.charCodeAt(r+1)<<8,l.push(s.charAt(a>>18)+s.charAt(a>>12&63)+s.charAt(a>>6&63)+t)}return l.join("")}}var z=q({__name:"index",setup(q){O(["MerchantId","islogin","InformationData","userinfo"]);const z=e({addressList:[],FormData:{name:"",phone:"",regionStr:"",area:""}}),{addressList:B,FormData:J}=a(z),P=s(!1),R=s(!1),E=s(!1),G=s(null);function H(){t({permission:"Shop-Address",queryField:"Id,UserName,Address,Mobile,DefaultChoose,DefaultChooseText",entityName:"CirclesFinancial.Modals.Shop.OrderAddress",whereField:"{}"}).then((e=>{const a=e.Result;a&&"object"==typeof a&&a.length>0?z.addressList=a:P.value=!0})).catch((e=>{}))}function K(e){if(e){console.log("弹窗数据===>",C(e));let a=C(e);z.FormData={name:a.UserName,phone:a.Mobile,regionStr:"",area:a.Address}}else z.FormData={name:"",phone:"",regionStr:"",area:""};R.value=!0}function Q(){E.value=!0}function W(){const e=z.FormData;if(!e.name)return void uni.$u.toast("请填写联系人姓名");if(!/(^1[3|4|5|7|8][0-9]{9}$)/.test(e.phone))return void uni.$u.toast("请输入正确的手机号码");if(!e.regionStr||!e.area)return void uni.$u.toast("请填写地址信息");let a={UserName:e.name,Mobile:e.phone,Address:e.regionStr+e.area},s={permission:"CreditScore-Address",queryField:"Id,UserName,Address,Mobile,DefaultChoose,DefaultChooseText",entityName:"CirclesFinancial.Modals.Shop.OrderAddress,CirclesFinancial.Modals",entityJson:T(JSON.stringify(a))};v(s).then((e=>{uni.$u.toast("保存成功"),z.addressList=[],H(),R.value=!1,z.FormData={name:"",phone:"",regionStr:"",area:""}})).catch((e=>{}))}return l((()=>{})),L(),F((e=>{H()})),w((()=>{console.log("页面出现时")})),U((()=>{console.log("页面准备好时")})),M((()=>{console.log("页面触底时")})),(e,a)=>{const s=A,l=d,t=N(y("u-icon"),j),C=k,v=x,F=b,w=N(y("u-popup"),I),U=N(y("u-picker"),$);return o(),r(l,{class:"page"},{default:n((()=>[P.value?(o(),r(l,{key:0,class:"text-center font-small"},{default:n((()=>[i(s,null,{default:n((()=>[c("还未有地址记录，点击")])),_:1}),i(s,{class:"color-main",onClick:a[0]||(a[0]=e=>K(null))},{default:n((()=>[c("添加")])),_:1})])),_:1})):u("v-if",!0),m(B).length>0?(o(),r(l,{key:1,class:"addressList"},{default:n((()=>[(o(!0),p(h,null,f(m(B),((e,a)=>(o(),r(l,{class:"item",key:e.Id,onClick:e=>function(e){console.log("选中地址==>",e),D.commit("AddressChoose",e),V()}(a)},{default:n((()=>[i(l,{class:"top"},{default:n((()=>[i(l,{class:"name"},{default:n((()=>[c(g(e.UserName),1)])),_:2},1024),i(l,{class:"phone"},{default:n((()=>[c(g(e.Mobile),1)])),_:2},1024),u(' <view class="tag">\n\t\t\t\t\t\t<text :class="{red:res.DefaultChoose==1}">{{ res.DefaultChooseText }}</text>\n\t\t\t\t\t</view> ')])),_:2},1024),i(l,{class:"bottom"},{default:n((()=>[i(l,{class:"w-90"},{default:n((()=>[c(g(e.Address),1)])),_:2},1024),i(l,{class:"",onClick:S((a=>K(e)),["stop"])},{default:n((()=>[i(t,{class:"w-10",name:"edit-pen",size:40,color:"#999999"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),u(' <view class="addSite" @tap="navTo(`./add`)"> '),i(l,{class:"addSite",onClick:a[1]||(a[1]=e=>K(null))},{default:n((()=>[i(l,{class:"add"},{default:n((()=>[i(t,{name:"plus",color:"#ffffff",class:"icon",size:30}),c("新建收货地址 ")])),_:1})])),_:1})])),_:1})):u("v-if",!0),i(w,{modelValue:R.value,"onUpdate:modelValue":a[5]||(a[5]=e=>R.value=e),mode:"center","border-radius":"14"},{default:n((()=>[i(l,{class:"wrap"},{default:n((()=>[i(l,{class:"top"},{default:n((()=>[i(l,{class:"item"},{default:n((()=>[i(l,{class:"left"},{default:n((()=>[c("收货人")])),_:1}),i(C,{class:"input",type:"text","placeholder-class":"line",placeholder:"请填写收货人姓名",modelValue:m(J).name,"onUpdate:modelValue":a[2]||(a[2]=e=>m(J).name=e)},null,8,["modelValue"])])),_:1}),i(l,{class:"item"},{default:n((()=>[i(l,{class:"left"},{default:n((()=>[c("手机号码")])),_:1}),i(C,{class:"input",type:"text","placeholder-class":"line",placeholder:"请填写收货人手机号",modelValue:m(J).phone,"onUpdate:modelValue":a[3]||(a[3]=e=>m(J).phone=e)},null,8,["modelValue"])])),_:1}),i(l,{class:"item",onClick:Q},{default:n((()=>[i(l,{class:"left"},{default:n((()=>[c("所在地区")])),_:1}),i(l,{class:"input",style:_(`color: ${m(J).regionStr?"#333":"#C7CBD2"};font-size: 28rpx;`)},{default:n((()=>[c(g(m(J).regionStr||"省市区县、乡镇等"),1)])),_:1},8,["style"]),u(' <view disabled type="text" placeholder-class="line" placeholder="省市区县、乡镇等" /> ')])),_:1}),i(l,{class:"item address"},{default:n((()=>[i(l,{class:"left"},{default:n((()=>[c("详细地址")])),_:1}),i(v,{class:"input",type:"text","placeholder-class":"line",placeholder:"街道、楼牌等",modelValue:m(J).area,"onUpdate:modelValue":a[4]||(a[4]=e=>m(J).area=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(F,{type:"primary",onClick:W},{default:n((()=>[c("确定")])),_:1})])),_:1})])),_:1},8,["modelValue"]),i(U,{"safe-area-inset-bottom":!0,mode:"region",ref_key:"regionPicker",ref:G,modelValue:E.value,"onUpdate:modelValue":a[6]||(a[6]=e=>E.value=e),onConfirm:a[7]||(a[7]=e=>{return a=e,console.log("地区==>",a),console.log("地区==>",Object.values(a)),console.log("地区==>",Object.keys(a)),void(z.FormData.regionStr=a.province.name+a.city.name+a.area.name);var a})},null,8,["modelValue"])])),_:1})}}},[["__scopeId","data-v-4a1c8e5d"]]);export{z as default};
